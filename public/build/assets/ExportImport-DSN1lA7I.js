import{d as Q,G as Y,M as V,r as h,c as N,b as u,o as d,f as o,C as s,L as Z,l as a,e,g as f,u as ee,t as r,h as p,w as T,i as k,F as b,k as S,H as C}from"./app-OOv3r1LF.js";import{_ as P}from"./index-Cm_CR8ff.js";import{_ as E,b as D,c as j,d as B,a as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-BySnt1Ai.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-D1Fylsa8.js";import{_ as te,a as se}from"./Layout.vue_vue_type_script_setup_true_lang-D_uuzJcJ.js";import{_ as oe}from"./Input.vue_vue_type_script_setup_true_lang-cUx5D4pf.js";import{D as $,C as U,i as le,F as g,P as J,j as R,k as ae,l as re,g as z,b as ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-B701zaDs.js";import"./useForwardExpose-DRNskkO_.js";import"./index-Cj25P1lV.js";import"./index-DQ-FA5Xf.js";import"./check-C-nUcYih.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-pw01pzy6.js";const ne={class:"space-y-6"},de={key:0,class:"rounded-md bg-green-50 p-4 border border-green-200"},ue={class:"flex"},pe={class:"ml-3"},me={class:"text-sm font-medium text-green-800"},ce={key:1,class:"rounded-md bg-blue-50 p-4 border border-blue-200"},fe={class:"flex"},ye={class:"flex-shrink-0"},ve={class:"ml-3"},_e={class:"text-sm font-medium text-blue-800"},be={class:"ml-auto pl-3"},xe={key:2,class:"rounded-md bg-red-50 p-4 border border-red-200"},ge={class:"flex"},we={class:"flex-shrink-0"},he={class:"ml-3"},ke={class:"text-sm font-medium text-red-800"},Se={class:"ml-auto pl-3"},Ce={class:"space-y-2"},Ee=["value"],De={key:0,class:"text-sm text-red-600"},je={class:"space-y-2"},Oe=["value"],$e={key:0,class:"text-sm text-red-600"},Le={class:"rounded-md bg-yellow-50 p-4 border border-yellow-200"},Fe={class:"flex"},Ie={class:"flex-shrink-0"},Me={class:"space-y-2"},Ve=["value"],Ne={key:0,class:"text-sm text-red-600"},Te={class:"space-y-2"},Pe={key:0,class:"text-sm text-red-600"},Be={class:"grid grid-cols-1 gap-x-4 gap-y-2 sm:grid-cols-2 text-sm"},Ue={class:"font-mono"},et=Q({__name:"ExportImport",props:{user:{},company:{}},setup(Je){const L=Y(),n=V({data_type:"",format:""}),m=V({file:null,import_type:""}),w=h(),y=h(""),v=h(""),q=async()=>{if(!(!n.data_type||!n.format)){n.processing=!0,y.value="",v.value="";try{const i=await fetch("/settings/export",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({data_type:n.data_type,format:n.format})});if(i.ok){const t=i.headers.get("Content-Disposition");let l=`export.${n.format}`;if(t){const M=t.match(/filename="(.+)"/);M&&(l=M[1])}const K=await i.blob(),I=window.URL.createObjectURL(K),_=document.createElement("a");_.href=I,_.download=l,document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(I),y.value=`âœ… ${l} downloaded successfully!`,n.reset()}else throw await i.text(),new Error(`Export failed: ${i.status} ${i.statusText}`)}catch(i){console.error("Export error:",i),v.value=`Failed to download export: ${i.message}`}finally{n.processing=!1}}},A=i=>{const t=i.target;t.files&&t.files.length>0&&(m.file=t.files[0])},W=()=>{m.post("/settings/import",{preserveScroll:!0,onSuccess:()=>{m.reset(),w.value&&(w.value.value="")}})},c=N(()=>L.props.errors||{}),F=N(()=>L.props.flash?.success||""),X=[{value:"all",label:"All Data",icon:le,description:"Export everything: projects, todos, comments, and users"},{value:"projects_todos",label:"Projects + To-Dos",icon:g,description:"Export projects with their todos (perfect for restore)"},{value:"projects",label:"Projects Only",icon:g,description:"Export only project information"},{value:"todos",label:"To-Dos Only",icon:J,description:"Export only task information"},{value:"comments",label:"Comments Only",icon:R,description:"Export only comment information"}],G=[{value:"json",label:"JSON Format",icon:ae,description:"Structured data format, best for re-importing"},{value:"csv",label:"CSV Format",icon:re,description:"Spreadsheet format, best for analysis"}],H=[{value:"projects_todos",label:"Projects + To-Dos",icon:g,description:"Import projects with their todos (restore functionality)"},{value:"projects",label:"Projects Only",icon:g,description:"Import project data only"},{value:"todos",label:"To-Dos Only",icon:J,description:"Import task data only"},{value:"comments",label:"Comments Only",icon:R,description:"Import comment data only"}];return(i,t)=>(d(),u(b,null,[o(s(Z),{title:"Export & Import"}),o(ie,null,{default:a(()=>[o(te,null,{default:a(()=>[e("div",ne,[t[26]||(t[26]=e("div",null,[e("h3",{class:"text-lg font-medium"},"Export & Import"),e("p",{class:"text-sm text-muted-foreground"}," Export your company data for backup or analysis, and import data from external sources. ")],-1)),o(s(se)),F.value?(d(),u("div",de,[e("div",ue,[t[5]||(t[5]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",pe,[e("p",me,r(F.value),1)])])])):f("",!0),y.value?(d(),u("div",ce,[e("div",fe,[e("div",ye,[o(s($),{class:"h-5 w-5 text-blue-400"})]),e("div",ve,[e("p",_e,r(y.value),1)]),e("div",be,[e("button",{onClick:t[0]||(t[0]=l=>y.value=""),class:"text-blue-400 hover:text-blue-600"},t[6]||(t[6]=[e("span",{class:"sr-only"},"Dismiss",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):f("",!0),v.value?(d(),u("div",xe,[e("div",ge,[e("div",we,[o(s(U),{class:"h-5 w-5 text-red-400"})]),e("div",he,[e("p",ke,r(v.value),1)]),e("div",Se,[e("button",{onClick:t[1]||(t[1]=l=>v.value=""),class:"text-red-400 hover:text-red-600"},t[7]||(t[7]=[e("span",{class:"sr-only"},"Dismiss",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):f("",!0),o(s(E),null,{default:a(()=>[o(s(D),null,{default:a(()=>[o(s(j),{class:"flex items-center gap-2"},{default:a(()=>[o(s($),{class:"h-5 w-5 text-blue-600"}),t[8]||(t[8]=p(" Export Data ",-1))]),_:1,__:[8]}),o(s(B),null,{default:a(()=>t[9]||(t[9]=[p(" Download your company data in JSON or CSV format for backup or analysis. ",-1)])),_:1,__:[9]})]),_:1}),o(s(O),{class:"space-y-6"},{default:a(()=>[e("form",{onSubmit:T(q,["prevent"]),class:"space-y-4"},[e("div",Ce,[o(s(x),{for:"data_type"},{default:a(()=>t[10]||(t[10]=[p("What data would you like to export?",-1)])),_:1,__:[10]}),k(e("select",{id:"data_type",name:"data_type","onUpdate:modelValue":t[2]||(t[2]=l=>s(n).data_type=l),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},[t[11]||(t[11]=e("option",{value:""},"Select data type...",-1)),(d(),u(b,null,S(X,l=>e("option",{key:l.value,value:l.value},r(l.label)+" - "+r(l.description),9,Ee)),64))],512),[[C,s(n).data_type]]),c.value.data_type?(d(),u("p",De,r(c.value.data_type),1)):f("",!0)]),e("div",je,[o(s(x),{for:"format"},{default:a(()=>t[12]||(t[12]=[p("Export format",-1)])),_:1,__:[12]}),k(e("select",{id:"format",name:"format","onUpdate:modelValue":t[3]||(t[3]=l=>s(n).format=l),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},[t[13]||(t[13]=e("option",{value:""},"Select format...",-1)),(d(),u(b,null,S(G,l=>e("option",{key:l.value,value:l.value},r(l.label)+" - "+r(l.description),9,Oe)),64))],512),[[C,s(n).format]]),c.value.format?(d(),u("p",$e,r(c.value.format),1)):f("",!0)]),o(s(P),{type:"submit",disabled:s(n).processing||!s(n).data_type||!s(n).format,class:"w-full"},{default:a(()=>[o(s($),{class:"mr-2 h-4 w-4"}),p(" "+r(s(n).processing?"Preparing Export...":"Export Data"),1)]),_:1},8,["disabled"])],32)]),_:1})]),_:1}),o(s(E),null,{default:a(()=>[o(s(D),null,{default:a(()=>[o(s(j),{class:"flex items-center gap-2"},{default:a(()=>[o(s(z),{class:"h-5 w-5 text-green-600"}),t[14]||(t[14]=p(" Import Data ",-1))]),_:1,__:[14]}),o(s(B),null,{default:a(()=>t[15]||(t[15]=[p(" Upload a JSON or CSV file to import data into your company workspace. ",-1)])),_:1,__:[15]})]),_:1}),o(s(O),{class:"space-y-6"},{default:a(()=>[e("div",Le,[e("div",Fe,[e("div",Ie,[o(s(U),{class:"h-5 w-5 text-yellow-400"})]),t[16]||(t[16]=e("div",{class:"ml-3"},[e("h4",{class:"text-sm font-medium text-yellow-800"},"Import Guidelines"),e("div",{class:"mt-2 text-sm text-yellow-700"},[e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Ensure your file follows the correct format (JSON/CSV)"),e("li",null,"Projects will be assigned to you as the owner"),e("li",null,"Duplicate data may be created if records already exist"),e("li",null,"Maximum file size: 10MB")])])],-1))])]),e("form",{onSubmit:T(W,["prevent"]),class:"space-y-4"},[e("div",Me,[o(s(x),{for:"import_type"},{default:a(()=>t[17]||(t[17]=[p("What type of data are you importing?",-1)])),_:1,__:[17]}),k(e("select",{id:"import_type",name:"import_type","onUpdate:modelValue":t[4]||(t[4]=l=>s(m).import_type=l),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},[t[18]||(t[18]=e("option",{value:""},"Select import type...",-1)),(d(),u(b,null,S(H,l=>e("option",{key:l.value,value:l.value},r(l.label)+" - "+r(l.description),9,Ve)),64))],512),[[C,s(m).import_type]]),c.value.import_type?(d(),u("p",Ne,r(c.value.import_type),1)):f("",!0)]),e("div",Te,[o(s(x),{for:"file"},{default:a(()=>t[19]||(t[19]=[p("Select file to import",-1)])),_:1,__:[19]}),o(s(oe),{ref_key:"fileInput",ref:w,type:"file",accept:".json,.csv,.txt",onChange:A,class:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,512),t[20]||(t[20]=e("p",{class:"text-xs text-muted-foreground"}," Supported formats: JSON, CSV (max 10MB) ",-1)),c.value.file?(d(),u("p",Pe,r(c.value.file),1)):f("",!0)]),o(s(P),{type:"submit",disabled:s(m).processing||!s(m).file||!s(m).import_type,class:"w-full"},{default:a(()=>[o(s(z),{class:"mr-2 h-4 w-4"}),p(" "+r(s(m).processing?"Importing...":"Import Data"),1)]),_:1},8,["disabled"])],32)]),_:1})]),_:1}),i.company?(d(),ee(s(E),{key:3},{default:a(()=>[o(s(D),null,{default:a(()=>[o(s(j),{class:"text-sm"},{default:a(()=>t[21]||(t[21]=[p("Export Information",-1)])),_:1,__:[21]})]),_:1}),o(s(O),null,{default:a(()=>[e("dl",Be,[e("div",null,[t[22]||(t[22]=e("dt",{class:"font-medium text-muted-foreground"},"Company",-1)),e("dd",null,r(i.company.name),1)]),e("div",null,[t[23]||(t[23]=e("dt",{class:"font-medium text-muted-foreground"},"Company Code",-1)),e("dd",Ue,r(i.company.code),1)]),e("div",null,[t[24]||(t[24]=e("dt",{class:"font-medium text-muted-foreground"},"Subscription",-1)),e("dd",null,r(i.company.subscription_type),1)]),e("div",null,[t[25]||(t[25]=e("dt",{class:"font-medium text-muted-foreground"},"Exported by",-1)),e("dd",null,r(i.user.name)+" ("+r(i.user.email)+")",1)])])]),_:1})]),_:1})):f("",!0)])]),_:1})]),_:1})],64))}});export{et as default};
