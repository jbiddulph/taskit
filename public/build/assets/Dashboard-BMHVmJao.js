import{d as A,r as u,A as $,c as g,o as p,i as w,e as t,a,b as s,t as c,n as b,j as m,F as j,l as x,w as v,B as S,h as F,p as P,g as W,C as D}from"./app-Bvd4__Z8.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-B55MpdUo.js";import{_ as U,a as X}from"./ActivityFeed.vue_vue_type_script_setup_true_lang-xUaIz6Qz.js";import{T as C,U as E,_ as k,a as B}from"./realtimeService-BqFW5mMs.js";import{X as I,F as L}from"./x-CQRGeDTl.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-CbXDW0ir.js";import"./index-C4-rBUmS.js";import"./useForwardExpose-CFEPl654.js";import"./Presence-OxHocnkl.js";import"./VisuallyHidden-CPIS7ckT.js";import"./index-CMWG4mbA.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DTnjY59v.js";import"./check-CUPMQmg2.js";import"./TodoComments.vue_vue_type_script_setup_true_lang-XlMHhS04.js";import"./lock-B6QBx_Zi.js";import"./globe-U3G7aQF6.js";import"./loader-circle-DyuwaP8b.js";const N={class:"space-y-2"},V={key:0,class:"flex items-center justify-between bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mx-4 mt-4",role:"alert"},R={class:"flex items-center gap-3"},q={class:"flex items-center gap-2"},z={class:"text-sm text-red-700 dark:text-red-300"},O={class:"flex items-center gap-3"},G={class:"flex items-center gap-2"},H={class:"text-sm text-red-700 dark:text-red-300"},J=A({__name:"LimitWarnings",props:{company:{}},setup(M){const e=M,h=u(sessionStorage.getItem(`member-warning-dismissed-${e.company.id}`)==="true"),f=u(sessionStorage.getItem(`project-warning-dismissed-${e.company.id}`)==="true"),n=$(()=>{if(h.value||e.company.subscription_type==="MAXI")return!1;const r=e.company.member_limit-1;return e.company.current_member_count>=r}),i=$(()=>{if(f.value||e.company.subscription_type==="MAXI")return!1;const r=Math.floor(e.company.project_limit*.8);return e.company.current_project_count>=r}),l=()=>{h.value=!0,sessionStorage.setItem(`member-warning-dismissed-${e.company.id}`,"true")},_=()=>{f.value=!0,sessionStorage.setItem(`project-warning-dismissed-${e.company.id}`,"true")},y=()=>e.company.subscription_type==="FREE"?"Upgrade to MIDI (£6/month) or MAXI (£9/month) to add more members.":"Upgrade to MAXI (£9/month) to add more members.",d=()=>e.company.subscription_type==="FREE"?{before:"to create more projects.",hasLinks:!0}:{before:"to create more projects.",hasLinks:!0,singlePlan:"MAXI"};return(r,o)=>(p(),g("div",N,[n.value?(p(),g("div",V,[t("div",R,[a(s(C),{class:"w-5 h-5 text-red-600 dark:text-red-400"}),t("div",null,[t("div",q,[a(s(E),{class:"w-4 h-4 text-red-600 dark:text-red-400"}),o[0]||(o[0]=t("span",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Member Limit Warning ",-1))]),t("p",z,c(r.company.current_member_count)+"/"+c(r.company.member_limit)+" members used. "+c(y()),1)])]),t("button",{onClick:l,class:"p-1 hover:bg-red-100 dark:hover:bg-red-800/30 rounded transition-colors","aria-label":"Dismiss warning"},[a(s(I),{class:"w-4 h-4 text-red-600 dark:text-red-400"})])])):w("",!0),i.value?(p(),g("div",{key:1,class:b(["flex items-center justify-between bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mx-4",{"mt-4":!n.value}]),role:"alert"},[t("div",O,[a(s(C),{class:"w-5 h-5 text-red-600 dark:text-red-400"}),t("div",null,[t("div",G,[a(s(L),{class:"w-4 h-4 text-red-600 dark:text-red-400"}),o[1]||(o[1]=t("span",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Project Limit Warning ",-1))]),t("p",H,[m(c(r.company.current_project_count)+"/"+c(r.company.project_limit)+" projects used. ",1),r.company.subscription_type==="FREE"?(p(),g(j,{key:0},[a(s(x),{href:"/subscription",class:"font-bold text-red-800 dark:text-red-200 hover:underline"},{default:v(()=>o[2]||(o[2]=[m(" Upgrade to MIDI (£6/month) ",-1)])),_:1,__:[2]}),o[4]||(o[4]=m(" or ",-1)),a(s(x),{href:"/subscription",class:"font-bold text-red-800 dark:text-red-200 hover:underline"},{default:v(()=>o[3]||(o[3]=[m(" MAXI (£9/month) ",-1)])),_:1,__:[3]}),m(" "+c(d().before),1)],64)):(p(),g(j,{key:1},[a(s(x),{href:"/subscription",class:"font-bold text-red-800 dark:text-red-200 hover:underline"},{default:v(()=>o[5]||(o[5]=[m(" Upgrade to MAXI (£9/month) ",-1)])),_:1,__:[5]}),m(" "+c(d().before),1)],64))])])]),t("button",{onClick:_,class:"p-1 hover:bg-red-100 dark:hover:bg-red-800/30 rounded transition-colors","aria-label":"Dismiss warning"},[a(s(I),{class:"w-4 h-4 text-red-600 dark:text-red-400"})])],2)):w("",!0)]))}}),K=["title"],Q=["title"],Y=["title"],Z={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},ee={class:"lg:col-span-1 activity-feed-container"},te=A({__name:"Dashboard",props:{user:{},company:{}},setup(M){const{t:e}=S(),h=[{title:e("dashboard.title"),href:"/dashboard"}],f=u(null),n=u(!1),i=u(!1);u(!1);const l=u(!1),_=d=>{f.value=d?.color||null},y=()=>{l.value=!l.value};return(d,r)=>(p(),g(j,null,[a(s(F),{title:s(e)("dashboard.title")},null,8,["title"]),a(T,{breadcrumbs:h,company:d.company,"project-color":f.value},{dashboardActions:v(()=>[t("button",{onClick:r[0]||(r[0]=o=>i.value=!i.value),title:i.value?s(e)("dashboard.hide_calendar"):s(e)("dashboard.show_calendar"),class:b(["inline-flex items-center justify-center p-2 transition-colors",i.value?"text-blue-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"])},[a(k,{name:"Calendar",class:"w-5 h-5"})],10,K),t("button",{onClick:r[1]||(r[1]=o=>n.value=!n.value),title:n.value?s(e)("dashboard.hide_activity_feed"):s(e)("dashboard.show_activity_feed"),class:b(["inline-flex items-center justify-center p-2 transition-colors",n.value?"text-blue-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"])},[a(k,{name:"Activity",class:"w-5 h-5"})],10,Q),t("button",{onClick:y,title:l.value?s(e)("dashboard.exit_select_mode"):s(e)("dashboard.select_for_bulk_update"),class:b(["inline-flex items-center justify-center p-2 transition-colors",l.value?"text-blue-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"])},[a(k,{name:"CheckSquare",class:"w-5 h-5"})],10,Y)]),default:v(()=>[d.company?(p(),P(J,{key:0,company:d.company},null,8,["company"])):w("",!0),t("div",Z,[t("div",{class:b(["grid gap-4 h-full",n.value?"grid-cols-1 lg:grid-cols-4":"grid-cols-1"])},[t("div",{class:b(n.value?"lg:col-span-3":"col-span-1")},[a(U,{onProjectChanged:_,"show-activity-feed":n.value,"show-calendar":i.value,"is-select-mode":l.value,onToggleActivityFeed:r[2]||(r[2]=o=>n.value=!n.value),onToggleCalendar:r[3]||(r[3]=o=>i.value=!i.value),onToggleSelectMode:y},null,8,["show-activity-feed","show-calendar","is-select-mode"])],2),W(t("div",ee,[a(X,{"company-id":d.company?.id||1,visible:n.value,class:"h-full"},null,8,["company-id","visible"])],512),[[D,n.value]])],2)])]),_:1},8,["company","project-color"])],64))}}),ye=B(te,[["__scopeId","data-v-15d95b6b"]]);export{ye as default};
