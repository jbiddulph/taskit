import{_ as h,a as Q,t as T,b as ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-ygyVvRIE.js";import{d as ge}from"./index-C61bzdNy.js";import{d as L,c as u,o as d,a as e,b as C,n as K,t as m,w as I,e as b,F,r as V,f as v,g as Y,h as ee,T as pe,i as te,j as R,k as x,v as P,l as E,m as X,p as fe,q as W,s as Z,u as H,x as ye,y as be}from"./app-C90VKL7K.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DBh6ouoC.js";import"./useForwardExpose-B2sWHaek.js";import"./check-8QeN4kC-.js";const me={class:"flex items-start justify-between mb-2"},ve={class:"flex items-center gap-2"},xe={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},we={class:"font-medium text-gray-900 dark:text-gray-100 mb-2 line-clamp-2"},ke={key:0,class:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2"},he={key:1,class:"flex flex-wrap gap-1 mb-3"},je={class:"flex items-center justify-between text-sm"},$e={class:"flex items-center gap-2"},_e={key:0,class:"w-6 h-6 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs font-medium"},Pe={key:1,class:"text-gray-400"},Ce={class:"flex items-center gap-1 text-gray-500"},Te={key:0},De={key:1},Se={key:2,class:"absolute top-2 right-2"},Ee={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 dark:bg-gray-700 text-xs font-medium text-gray-700 dark:text-gray-300"},Ie=L({__name:"TodoCard",props:{todo:{}},emits:["edit","delete"],setup(S,{emit:f}){const g=S,w=f,y={Low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-yellow-200",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",High:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",Critical:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};let l=!1;const a=()=>{l||w("edit",g.todo),l=!1},p=c=>{const j=new Date(c),$=new Date,D=j.getTime()-$.getTime(),i=Math.ceil(D/(1e3*60*60*24));return i<0?`${Math.abs(i)}d overdue`:i===0?"Today":i===1?"Tomorrow":i<=7?`${i}d`:j.toLocaleDateString()};return(c,j)=>(d(),u("div",{class:"group relative bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:a},[e("div",me,[e("div",ve,[e("span",{class:K(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",y[c.todo.priority]])},m(c.todo.priority),3),c.todo.type?(d(),u("span",xe,m(c.todo.type),1)):C("",!0)]),e("button",{onClick:j[0]||(j[0]=I($=>c.$emit("delete",c.todo.id),["stop"])),class:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500 transition-opacity"},[b(h,{name:"Trash2",class:"w-4 h-4"})])]),e("h3",we,m(c.todo.title),1),c.todo.description?(d(),u("p",ke,m(c.todo.description),1)):C("",!0),c.todo.tags&&c.todo.tags.length?(d(),u("div",he,[(d(!0),u(F,null,V(c.todo.tags,$=>(d(),u("span",{key:$,class:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},m($),1))),128))])):C("",!0),e("div",je,[e("div",$e,[c.todo.assignee?(d(),u("div",_e,m(c.todo.assignee.charAt(0).toUpperCase()),1)):(d(),u("span",Pe,"Unassigned"))]),e("div",Ce,[b(h,{name:"Calendar",class:"w-4 h-4"}),c.todo.due_date?(d(),u("span",Te,m(p(c.todo.due_date)),1)):(d(),u("span",De,"No due date"))])]),c.todo.story_points?(d(),u("div",Se,[e("span",Ee,m(c.todo.story_points),1)])):C("",!0)]))}}),Fe=Q(Ie,[["__scopeId","data-v-6bce560b"]]),Ue={class:"flex flex-col h-full min-w-80"},Ve={class:"flex items-center justify-between mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Le={class:"flex items-center gap-2"},Me={class:"font-semibold text-gray-900 dark:text-gray-100"},Ae={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-600 text-xs font-medium text-gray-700 dark:text-gray-300"},Be={class:"flex items-center gap-2"},Ne={key:0,class:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400"},qe={key:1,class:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 border-2 border-blue-300 rounded-lg flex items-center justify-center pointer-events-none"},Oe=["draggable","onDragstart"],ze=L({__name:"TodoColumn",props:{title:{},status:{},todos:{},showAddButton:{type:Boolean,default:!1},currentProjectId:{}},emits:["add","edit","delete","menu","drop"],setup(S,{emit:f}){const g=S,w=f,y=v(),l=v(!1),a=v(null),p=o=>!g.currentProjectId||o.project_id===g.currentProjectId,c=(o,r)=>{if(console.log("Drag start:",r.title,"Status:",r.status,"Column:",g.status),g.currentProjectId&&r.project_id!==g.currentProjectId){console.log("Cannot drag todo from different project:",r.project_id,"vs",g.currentProjectId),o.preventDefault();return}o.dataTransfer&&(o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("text/plain",r.id),o.dataTransfer.setData("application/json",JSON.stringify(r)),a.value=r,console.log("Set draggedTodo:",a.value?.title))},j=()=>{console.log("Drag end in column:",g.status,"draggedTodo:",a.value?.title),a.value&&a.value.status===g.status&&(console.log("Clearing draggedTodo in source column:",g.status),a.value=null)},$=o=>{o.preventDefault(),o.stopPropagation(),o.dataTransfer&&(o.dataTransfer.dropEffect="move"),l.value=!0,console.log("Drag over column:",g.status,"isDragOver:",l.value)},D=o=>{console.log("Drag leave column:",g.status),o.currentTarget===y.value&&(l.value=!1)},i=o=>{console.log("Drop event triggered in column:",g.status),o.preventDefault(),o.stopPropagation(),l.value=!1;const r=o.dataTransfer?.getData("text/plain"),k=o.dataTransfer?.getData("application/json");if(console.log("Drop dataTransfer todoId:",r,"todoJson:",k),k)try{const _=JSON.parse(k);console.log("Parsed todo from dataTransfer:",_.title,"Status:",_.status),_.status!==g.status?(console.log("Emitting drop event:",_.title,"->",g.status),w("drop",_,g.status)):console.log("Cannot drop to same status")}catch(_){console.error("Failed to parse todo from dataTransfer:",_)}else console.log("No todo data in dataTransfer")};return(o,r)=>(d(),u("div",Ue,[e("div",Ve,[e("div",Le,[e("h3",Me,m(o.title),1),e("span",Ae,m(o.todos.length),1)]),e("div",Be,[o.showAddButton?(d(),u("button",{key:0,onClick:r[0]||(r[0]=k=>o.$emit("add")),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},[b(h,{name:"Plus",class:"w-4 h-4"})])):C("",!0),e("button",{onClick:r[1]||(r[1]=k=>o.$emit("menu")),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},[b(h,{name:"MoreHorizontal",class:"w-4 h-4"})])])]),e("div",{ref_key:"dropZone",ref:y,class:K(["flex-1 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-700 min-h-[400px] transition-colors relative",{"border-blue-300 bg-blue-50 dark:bg-blue-900/20":l.value,"border-gray-200 dark:border-gray-700":!l.value}]),onDragover:I($,["prevent"]),onDragleave:D,onDrop:i,onDragenter:r[4]||(r[4]=I(()=>{},["prevent"]))},[o.todos.length===0?(d(),u("div",Ne,[b(h,{name:"Inbox",class:"w-12 h-12 mb-2 opacity-50"}),r[5]||(r[5]=e("p",{class:"text-sm text-center"},"No todos yet",-1)),r[6]||(r[6]=e("p",{class:"text-xs text-center opacity-75"},"Drag and drop here or click + to add",-1))])):C("",!0),l.value?(d(),u("div",qe,r[7]||(r[7]=[e("div",{class:"text-blue-600 dark:text-blue-300 text-lg font-medium"}," Drop here to move todo ",-1)]))):(d(),Y(pe,{key:2,name:"todo-list",tag:"div",class:"space-y-3"},{default:ee(()=>[(d(!0),u(F,null,V(o.todos,k=>(d(),u("div",{key:k.id,draggable:p(k),onDragstart:_=>c(_,k),onDragend:j,class:K(["transform transition-transform duration-200",{"hover:scale-[1.02]":p(k),"opacity-60 cursor-not-allowed":!p(k)}])},[b(Fe,{todo:k,onEdit:r[2]||(r[2]=_=>o.$emit("edit",_)),onDelete:r[3]||(r[3]=_=>o.$emit("delete",_))},null,8,["todo"])],42,Oe))),128))]),_:1}))],34)]))}}),J=Q(ze,[["__scopeId","data-v-cf9746fa"]]),He={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Je={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Ke={class:"p-6"},Re={class:"flex items-center justify-between mb-6"},Xe={class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},We=["value","selected"],Ze={class:"grid grid-cols-2 gap-4"},Ge={class:"grid grid-cols-2 gap-4"},Qe={class:"grid grid-cols-2 gap-4"},Ye=["onKeydown"],et={key:0,class:"flex flex-wrap gap-2"},tt=["onClick"],ot={class:"flex justify-end gap-3 pt-4"},rt={type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"},st=L({__name:"TodoForm",props:{todo:{},isEditing:{type:Boolean,default:!1},currentProject:{}},emits:["close","save"],setup(S,{emit:f}){const g=S,w=f,y=v([]),l=v({id:"",project_id:"",title:"",description:"",priority:"Medium",type:"",tags:[],assignee:"",due_date:"",story_points:void 0,status:"todo"}),a=v(""),p=async()=>{try{y.value=await T.getProjects()}catch(i){console.error("Failed to load projects:",i)}},c=()=>{l.value={id:"",project_id:"",title:"",description:"",priority:"Medium",type:"",tags:[],assignee:"",due_date:"",story_points:void 0,status:"todo"},a.value=""};te(()=>{p()}),R(()=>g.todo,i=>{i?l.value={...i}:(c(),g.currentProject&&(l.value.project_id=g.currentProject.id.toString()))},{immediate:!0});const j=()=>{const i=a.value.trim();i&&!l.value.tags?.includes(i)&&(l.value.tags||(l.value.tags=[]),l.value.tags.push(i),a.value="")},$=i=>{l.value.tags&&(l.value.tags=l.value.tags.filter(o=>o!==i))},D=async()=>{try{const i={...l.value,project_id:parseInt(l.value.project_id),due_date:l.value.due_date||null,story_points:l.value.story_points||null};g.isEditing&&(i.id=parseInt(l.value.id)),w("save",i),c()}catch(i){console.error("Failed to submit todo:",i)}};return(i,o)=>(d(),u("div",He,[e("div",Je,[e("div",Ke,[e("div",Re,[e("h2",Xe,m(i.isEditing?"Edit Todo":"Add New Todo"),1),e("button",{onClick:o[0]||(o[0]=r=>i.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[b(h,{name:"X",class:"w-6 h-6"})])]),e("form",{onSubmit:I(D,["prevent"]),class:"space-y-4"},[e("div",null,[o[12]||(o[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title * ",-1)),x(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>l.value.title=r),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter todo title"},null,512),[[P,l.value.title]])]),e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description ",-1)),x(e("textarea",{"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.description=r),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter description (optional)"},null,512),[[P,l.value.description]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project * ",-1)),x(e("select",{"onUpdate:modelValue":o[3]||(o[3]=r=>l.value.project_id=r),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[o[14]||(o[14]=e("option",{value:""},"Select Project",-1)),(d(!0),u(F,null,V(y.value,r=>(d(),u("option",{key:r.id,value:r.id,selected:!i.isEditing&&i.currentProject&&r.id===i.currentProject.id},m(r.key)+" - "+m(r.name),9,We))),128))],512),[[E,l.value.project_id]])]),e("div",Ze,[e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Priority * ",-1)),x(e("select",{"onUpdate:modelValue":o[4]||(o[4]=r=>l.value.priority=r),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},o[16]||(o[16]=[e("option",{value:"Low"},"Low",-1),e("option",{value:"Medium"},"Medium",-1),e("option",{value:"High"},"High",-1),e("option",{value:"Critical"},"Critical",-1)]),512),[[E,l.value.priority]])]),e("div",null,[o[19]||(o[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Type ",-1)),x(e("select",{"onUpdate:modelValue":o[5]||(o[5]=r=>l.value.type=r),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},o[18]||(o[18]=[X('<option value="">Select type</option><option value="Bug">Bug</option><option value="Feature">Feature</option><option value="Task">Task</option><option value="Story">Story</option><option value="Epic">Epic</option>',6)]),512),[[E,l.value.type]])])]),e("div",Ge,[e("div",null,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Assignee ",-1)),x(e("input",{"onUpdate:modelValue":o[6]||(o[6]=r=>l.value.assignee=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter assignee name"},null,512),[[P,l.value.assignee]])]),e("div",null,[o[21]||(o[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Due Date ",-1)),x(e("input",{"onUpdate:modelValue":o[7]||(o[7]=r=>l.value.due_date=r),type:"date",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,512),[[P,l.value.due_date]])])]),e("div",Qe,[e("div",null,[o[22]||(o[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Story Points ",-1)),x(e("input",{"onUpdate:modelValue":o[8]||(o[8]=r=>l.value.story_points=r),type:"number",min:"1",max:"21",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"1-21"},null,512),[[P,l.value.story_points,void 0,{number:!0}]])]),e("div",null,[o[23]||(o[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Tags ",-1)),x(e("input",{"onUpdate:modelValue":o[9]||(o[9]=r=>a.value=r),type:"text",onKeydown:fe(I(j,["prevent"]),["enter"]),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Type and press Enter to add tags"},null,40,Ye),[[P,a.value]])])]),l.value.tags&&l.value.tags.length>0?(d(),u("div",et,[(d(!0),u(F,null,V(l.value.tags,r=>(d(),u("span",{key:r,class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},[W(m(r)+" ",1),e("button",{type:"button",onClick:k=>$(r),class:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200"},[b(h,{name:"X",class:"w-3 h-3"})],8,tt)]))),128))])):C("",!0),e("div",null,[o[25]||(o[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Status * ",-1)),x(e("select",{"onUpdate:modelValue":o[10]||(o[10]=r=>l.value.status=r),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},o[24]||(o[24]=[e("option",{value:"todo"},"To Do",-1),e("option",{value:"in-progress"},"In Progress",-1),e("option",{value:"done"},"Done",-1)]),512),[[E,l.value.status]])]),e("div",ot,[e("button",{type:"button",onClick:o[11]||(o[11]=r=>i.$emit("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Cancel "),e("button",rt,m(i.isEditing?"Update":"Create"),1)])],32)])])]))}}),at={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},lt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},nt={class:"flex items-center"},dt={class:"flex-shrink-0"},it={class:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center"},ut={class:"ml-4"},ct={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},gt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},pt={class:"flex items-center"},ft={class:"flex-shrink-0"},yt={class:"w-8 h-8 bg-yellow-100 dark:bg-yellow-900 rounded-lg flex items-center justify-center"},bt={class:"ml-4"},mt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},vt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},xt={class:"flex items-center"},wt={class:"flex-shrink-0"},kt={class:"w-8 h-8 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center"},ht={class:"ml-4"},jt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},$t={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},_t={class:"flex items-center"},Pt={class:"flex-shrink-0"},Ct={class:"w-8 h-8 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center"},Tt={class:"ml-4"},Dt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},St=L({__name:"TodoStats",props:{todos:{}},setup(S){const f=S,g=Z(()=>{const w=new Date,y=new Date(w.getFullYear(),w.getMonth(),w.getDate()),l=f.todos.filter(p=>p.due_date?new Date(p.due_date)<y&&p.status!=="done":!1).length,a=f.todos.filter(p=>p.due_date?new Date(p.due_date).getTime()===y.getTime():!1).length;return{total:f.todos.length,todo:f.todos.filter(p=>p.status==="todo").length,inProgress:f.todos.filter(p=>p.status==="in-progress").length,done:f.todos.filter(p=>p.status==="done").length,overdue:l,dueToday:a}});return(w,y)=>(d(),u("div",at,[e("div",lt,[e("div",nt,[e("div",dt,[e("div",it,[b(h,{name:"List",class:"w-5 h-5 text-blue-600 dark:text-blue-400"})])]),e("div",ut,[y[0]||(y[0]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Todos",-1)),e("p",ct,m(g.value.total),1)])])]),e("div",gt,[e("div",pt,[e("div",ft,[e("div",yt,[b(h,{name:"Clock",class:"w-5 h-5 text-yellow-600 dark:text-yellow-400"})])]),e("div",bt,[y[1]||(y[1]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"In Progress",-1)),e("p",mt,m(g.value.inProgress),1)])])]),e("div",vt,[e("div",xt,[e("div",wt,[e("div",kt,[b(h,{name:"CheckCircle",class:"w-5 h-5 text-green-600 dark:text-green-400"})])]),e("div",ht,[y[2]||(y[2]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Completed",-1)),e("p",jt,m(g.value.done),1)])])]),e("div",$t,[e("div",_t,[e("div",Pt,[e("div",Ct,[b(h,{name:"AlertTriangle",class:"w-5 h-5 text-red-600 dark:text-red-400"})])]),e("div",Tt,[y[3]||(y[3]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Overdue",-1)),e("p",Dt,m(g.value.overdue),1)])])])]))}}),Et={class:"h-full flex flex-col"},It={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Ft={class:"flex-1"},Ut={class:"flex items-center gap-3 mb-2"},Vt={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Lt={class:"text-gray-600 dark:text-gray-400"},Mt={key:0,class:"mt-4"},At={class:"flex items-center gap-3"},Bt={class:"relative flex items-center gap-2"},Nt={key:1,class:"w-4 h-4 rounded-full flex-shrink-0 bg-gray-300"},qt=["value"],Ot=["disabled"],zt={class:"mt-4 flex flex-col lg:flex-row gap-4"},Ht={class:"flex-1 relative"},Jt={class:"flex gap-2"},Kt=["value"],Rt={class:"flex-1 flex gap-6 overflow-x-auto pb-4"},Xt={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Wt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full"},Zt={class:"p-6"},Gt={class:"flex items-center justify-between mb-6"},Qt={class:"flex items-center gap-3"},Yt={class:"text-sm text-gray-600 dark:text-gray-400"},eo={class:"flex gap-3 pt-4"},to={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},oo={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full"},ro={class:"p-6"},so={class:"flex items-center justify-between mb-6"},ao={class:"flex gap-3 pt-4"},lo=L({__name:"TodoBoard",setup(S){const f=v([]),g=v([]),w=v(!1),y=v(!1),l=v(!1),a=v(null),p=v(""),c=v(null),j=v(""),$=v(""),D=v(""),i=v(""),o=v(""),r=v({name:"",description:"",key:"",color:"#3B82F6"}),k=Z(()=>{let s=f.value.filter(t=>{const n=!$.value||t.title.toLowerCase().includes($.value.toLowerCase())||t.description?.toLowerCase().includes($.value.toLowerCase())||t.tags?.some(ue=>ue.toLowerCase().includes($.value.toLowerCase())),U=!D.value||t.priority===D.value,z=!i.value||t.type===i.value,ie=!o.value||t.assignee===o.value;return n&&U&&z&&ie});return{todo:s.filter(t=>t.status==="todo"),inProgress:s.filter(t=>t.status==="in-progress"),done:s.filter(t=>t.status==="done")}}),_=Z(()=>{const s=f.value.map(t=>t.assignee).filter(Boolean);return[...new Set(s)]}),A=s=>{c.value={...s},w.value=!0},oe=async s=>{try{if(!a.value){window.$notify&&window.$notify({type:"error",title:"Project Required",message:"Please select a project first before creating a todo."});return}if(c.value){const t=await T.updateTodo(s.id,s),n=f.value.findIndex(U=>U.id===s.id);n!==-1&&(f.value[n]=t),c.value=null,window.$notify&&window.$notify({type:"success",title:"Todo Updated",message:`Todo "${t.title}" has been updated successfully.`})}else{const t=await T.createTodo({...s,project_id:a.value.id});f.value.push(t),window.$notify&&window.$notify({type:"success",title:"Todo Created",message:`Todo "${t.title}" has been created successfully.`})}w.value=!1,window.dispatchEvent(new CustomEvent("projectCreated")),window.dispatchEvent(new CustomEvent("todoChanged"))}catch(t){console.error("Failed to save todo:",t),window.$notify&&window.$notify({type:"error",title:"Save Failed",message:"Failed to save todo. Please try again."})}},B=async s=>{const t=f.value.find(n=>n.id===s);if(t&&confirm(`Are you sure you want to delete "${t.title}"?

This action cannot be undone.`))try{await T.deleteTodo(s),f.value=f.value.filter(n=>n.id!==s),window.dispatchEvent(new CustomEvent("todoChanged")),window.$notify&&window.$notify({type:"success",title:"Todo Deleted",message:`Todo "${t.title}" has been deleted successfully.`})}catch(n){console.error("Failed to delete todo:",n),window.$notify&&window.$notify({type:"error",title:"Delete Failed",message:"Failed to delete todo. Please try again."})}},N=async(s,t)=>{if(console.log("TodoBoard received drop event:",s.title,"->",t),!a.value){window.$notify&&window.$notify({type:"error",title:"Project Required",message:"Please select a project before moving todos."});return}if(s.project_id!==a.value.id){window.$notify&&window.$notify({type:"error",title:"Invalid Move",message:`Cannot move todo "${s.title}" - it belongs to a different project.`});return}try{const n=await T.updateTodoStatus(s.id,t);console.log("API response:",n);const U=f.value.findIndex(z=>z.id===s.id);U!==-1&&(f.value[U]=n,console.log("Todo updated in local state"),window.dispatchEvent(new CustomEvent("todoChanged")),window.$notify&&window.$notify({type:"success",title:"Status Updated",message:`Todo "${n.title}" moved to ${t.replace("-"," ")}.`}))}catch(n){console.error("Failed to update todo status:",n),window.$notify&&window.$notify({type:"error",title:"Update Failed",message:"Failed to update todo status. Please try again."})}},re=()=>{w.value=!1,c.value=null},G=()=>{if(!a.value){window.$notify&&window.$notify({type:"warning",title:"Project Required",message:"Please select a project first before creating a todo."});return}w.value=!0},se=()=>{a.value&&(j.value=a.value.name,l.value=!0)},ae=async()=>{if(!(!a.value||!j.value.trim()))try{const s=await T.updateProject(a.value.id,{name:j.value.trim()});a.value={...a.value,...s},window.$notify&&window.$notify({type:"success",title:"Project Updated",message:`Project "${s.name}" has been updated successfully.`}),l.value=!1,j.value="",window.dispatchEvent(new CustomEvent("todoChanged")),console.log("Project updated successfully:",s.name)}catch(s){console.error("Failed to update project:",s),window.$notify&&window.$notify({type:"error",title:"Update Failed",message:"Failed to update project. Please try again."})}},q=()=>{r.value={name:"",description:"",key:"",color:"#3B82F6"}},le=async()=>{try{const s={name:r.value.name,description:r.value.description||void 0,key:r.value.key||void 0,color:r.value.color},t=await T.createProject(s);a.value=t,localStorage.setItem("currentProjectId",t.id.toString()),y.value=!1,q(),await M(),window.dispatchEvent(new CustomEvent("projectCreated")),window.dispatchEvent(new CustomEvent("todoChanged")),window.$notify&&window.$notify({type:"success",title:"Project Created",message:`Project "${t.name}" has been created successfully.`}),console.log("Project created successfully:",t.name)}catch(s){console.error("Failed to create project:",s),window.$notify&&window.$notify({type:"error",title:"Creation Failed",message:"Failed to create project. Please try again."})}},ne=async()=>{try{console.log("Loading projects...");const s=await T.getProjectsWithStats();console.log("Projects response:",s),g.value=s.data,console.log("Projects loaded:",g.value.length,"projects"),a.value&&(p.value=a.value.id.toString(),console.log("Set selected project ID to:",p.value))}catch(s){console.error("Failed to load projects:",s)}},de=async()=>{if(console.log("Project selection changed to:",p.value),!p.value){console.log("No project selected, clearing current project"),a.value=null,localStorage.removeItem("currentProjectId"),f.value=[];return}try{const s=parseInt(p.value);console.log("Loading project with ID:",s);const t=await T.getProject(s);console.log("Project loaded:",t),a.value=t,localStorage.setItem("currentProjectId",s.toString()),await M(),window.$notify&&window.$notify({type:"success",title:"Project Selected",message:`Switched to project "${t.name}".`})}catch(s){console.error("Failed to load project:",s),window.$notify&&window.$notify({type:"error",title:"Project Load Failed",message:"Failed to load the selected project. Please try again."})}},O=async()=>{try{const s=localStorage.getItem("currentProjectId");if(s){const t=await T.getProject(parseInt(s));a.value=t,p.value=s}}catch(s){console.error("Failed to load current project:",s),localStorage.removeItem("currentProjectId")}},M=async()=>{try{const s={};a.value&&(s.project_id=a.value.id);const t=await T.getTodos(s);f.value=t.data.todo.concat(t.data["in-progress"]).concat(t.data.done)}catch(s){console.error("Failed to load todos:",s)}};return R(a,async s=>{s&&(p.value=s.id.toString()),await M()}),R(y,s=>{s&&q()}),te(async()=>{await ne(),await O(),await M();const s=t=>{t.key==="currentProjectId"&&O()};window.addEventListener("storage",s),window.addEventListener("projectSelected",async t=>{t.detail?.projectId&&(localStorage.setItem("currentProjectId",t.detail.projectId.toString()),await O())}),window.addEventListener("openCreateProjectModal",()=>{y.value=!0,q()})}),(s,t)=>(d(),u("div",Et,[e("div",{class:"mb-6 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 relative overflow-hidden",style:H(a.value?{borderTop:`4px solid ${a.value.color}`,backgroundColor:`${a.value.color}10`}:{})},[e("div",It,[e("div",Ft,[e("div",Ut,[e("h1",Vt,m(a.value?a.value.name:"Todo Board"),1),a.value?(d(),u("button",{key:0,onClick:se,class:"p-1 text-gray-400 hover:text-blue-500 transition-colors",title:"Edit project name"},[b(h,{name:"Edit3",class:"w-5 h-5"})])):C("",!0)]),e("p",Lt,m(a.value?`Project: ${a.value.key} - ${a.value.description||"No description"}`:"Select a project to manage todos"),1),a.value?C("",!0):(d(),u("div",Mt,[e("button",{onClick:t[0]||(t[0]=n=>y.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"},[b(h,{name:"Plus",class:"w-4 h-4"}),t[15]||(t[15]=W(" Create Project ",-1))])]))]),e("div",At,[e("div",Bt,[a.value?(d(),u("div",{key:0,class:"w-4 h-4 rounded-full flex-shrink-0",style:H({backgroundColor:a.value.color})},null,4)):(d(),u("div",Nt)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>p.value=n),onChange:de,class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-w-[200px] cursor-pointer",style:H(a.value?{borderLeftColor:a.value.color,borderLeftWidth:"4px"}:{})},[t[16]||(t[16]=e("option",{value:""},"Select a Project",-1)),(d(!0),u(F,null,V(g.value,n=>(d(),u("option",{key:n.id,value:n.id},m(n.name)+" ("+m(n.key)+") ",9,qt))),128))],36),[[E,p.value]])]),e("button",{onClick:G,disabled:!a.value,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[b(h,{name:"Plus",class:"w-4 h-4"}),t[17]||(t[17]=W(" Add Todo ",-1))],8,Ot)])]),e("div",zt,[e("div",Ht,[b(h,{name:"Search",class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>$.value=n),type:"text",placeholder:"Search todos...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},null,512),[[P,$.value]])]),e("div",Jt,[x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=n=>D.value=n),class:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},t[18]||(t[18]=[X('<option value="">All Priorities</option><option value="Low">Low</option><option value="Medium">Medium</option><option value="High">High</option><option value="Critical">Critical</option>',5)]),512),[[E,D.value]]),x(e("select",{"onUpdate:modelValue":t[4]||(t[4]=n=>i.value=n),class:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},t[19]||(t[19]=[X('<option value="">All Types</option><option value="Bug">Bug</option><option value="Feature">Feature</option><option value="Task">Task</option><option value="Story">Story</option><option value="Epic">Epic</option>',6)]),512),[[E,i.value]]),x(e("select",{"onUpdate:modelValue":t[5]||(t[5]=n=>o.value=n),class:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},[t[20]||(t[20]=e("option",{value:""},"All Assignees",-1)),(d(!0),u(F,null,V(_.value,n=>(d(),u("option",{key:n,value:n},m(n),9,Kt))),128))],512),[[E,o.value]])])])],4),b(St,{todos:f.value},null,8,["todos"]),e("div",Rt,[b(J,{title:"To Do",status:"todo",todos:k.value.todo,"show-add-button":!0,"current-project-id":a.value?.id||null,onAdd:G,onEdit:A,onDelete:B,onDrop:N,onMenu:()=>{}},null,8,["todos","current-project-id"]),b(J,{title:"In Progress",status:"in-progress",todos:k.value.inProgress,"current-project-id":a.value?.id||null,onEdit:A,onDelete:B,onDrop:N,onMenu:()=>{}},null,8,["todos","current-project-id"]),b(J,{title:"Done",status:"done",todos:k.value.done,"current-project-id":a.value?.id||null,onEdit:A,onDelete:B,onDrop:N,onMenu:()=>{}},null,8,["todos","current-project-id"])]),w.value?(d(),Y(st,{key:0,todo:c.value,"is-editing":!!c.value,"current-project":a.value,onClose:re,onSave:oe},null,8,["todo","is-editing","current-project"])):C("",!0),y.value?(d(),u("div",Xt,[e("div",Wt,[e("div",Zt,[e("div",Gt,[t[21]||(t[21]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},"Create New Project",-1)),e("button",{onClick:t[6]||(t[6]=n=>y.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[b(h,{name:"X",class:"w-6 h-6"})])]),e("form",{onSubmit:I(le,["prevent"]),class:"space-y-4"},[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project Name * ",-1)),x(e("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>r.value.name=n),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project name"},null,512),[[P,r.value.name]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description (Optional) ",-1)),x(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=n=>r.value.description=n),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project description"},null,512),[[P,r.value.description]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project Key (Optional) ",-1)),x(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>r.value.key=n),type:"text",maxlength:"10",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., PROJ, FEAT"},null,512),[[P,r.value.key]]),t[25]||(t[25]=e("p",{class:"text-sm text-gray-500 mt-1"},"Leave empty to auto-generate",-1))]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Color ",-1)),e("div",Qt,[x(e("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>r.value.color=n),type:"color",class:"w-12 h-10 border border-gray-300 dark:border-gray-600 rounded-md cursor-pointer"},null,512),[[P,r.value.color]]),e("span",Yt,m(r.value.color),1)])]),e("div",eo,[t[27]||(t[27]=e("button",{type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Create Project ",-1)),e("button",{type:"button",onClick:t[11]||(t[11]=n=>y.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"}," Cancel ")])],32)])])])):C("",!0),l.value?(d(),u("div",to,[e("div",oo,[e("div",ro,[e("div",so,[t[28]||(t[28]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},"Edit Project",-1)),e("button",{onClick:t[12]||(t[12]=n=>l.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[b(h,{name:"X",class:"w-6 h-6"})])]),e("form",{onSubmit:I(ae,["prevent"]),class:"space-y-4"},[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project Name * ",-1)),x(e("input",{"onUpdate:modelValue":t[13]||(t[13]=n=>j.value=n),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project name"},null,512),[[P,j.value]])]),e("div",ao,[t[30]||(t[30]=e("button",{type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Save Changes ",-1)),e("button",{type:"button",onClick:t[14]||(t[14]=n=>l.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"}," Cancel ")])],32)])])])):C("",!0)]))}}),no={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},yo=L({__name:"Dashboard",setup(S){const f=[{title:"Dashboard",href:ge().url}];return(g,w)=>(d(),u(F,null,[b(ye(be),{title:"Dashboard"}),b(ce,{breadcrumbs:f},{default:ee(()=>[e("div",no,[b(lo)])]),_:1})],64))}});export{yo as default};
