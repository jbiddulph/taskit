import{d as C,r as u,A as I,c as b,o as p,k as w,b as t,a,u as s,t as c,n as f,f as m,F as j,l as x,w as v,B as A,h as U,q as E,j as D,C as T}from"./app-uipus-R9.js";import{_ as B}from"./AppLayout.vue_vue_type_script_setup_true_lang-CuCyKhBj.js";import{_ as F,a as P}from"./ActivityFeed.vue_vue_type_script_setup_true_lang-CM34Q0w7.js";import{T as M,U as W,_ as k,a as N}from"./useClientStore-D-HfPBWf.js";import{X as $,F as X}from"./x-66FeVDWX.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-A95SWG9X.js";import"./index-DgbrlomV.js";import"./useForwardExpose-CvJH8M7c.js";import"./Presence-D2_PsX8x.js";import"./VisuallyHidden-C75Gjzll.js";import"./index-CMWG4mbA.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CRCujEaM.js";import"./check-CijJQWIk.js";import"./createLucideIcon-Hns4JFYG.js";import"./TodoComments.vue_vue_type_script_setup_true_lang-jD6UmAYl.js";import"./lock-CoicbB5r.js";import"./globe-DjtFdb2E.js";import"./loader-circle-DFoNdqN7.js";const L={class:"space-y-2"},V={key:0,class:"flex items-center justify-between bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mx-4 mt-4",role:"alert"},R={class:"flex items-center gap-3"},q={class:"flex items-center gap-2"},z={class:"text-sm text-red-700 dark:text-red-300"},O={class:"flex items-center gap-3"},G={class:"flex items-center gap-2"},H={class:"text-sm text-red-700 dark:text-red-300"},J=C({__name:"LimitWarnings",props:{company:{}},setup(S){const e=S,y=u(sessionStorage.getItem(`member-warning-dismissed-${e.company.id}`)==="true"),g=u(sessionStorage.getItem(`project-warning-dismissed-${e.company.id}`)==="true"),n=I(()=>{if(y.value||e.company.subscription_type==="MAXI"||e.company.subscription_type==="BUSINESS"||e.company.subscription_type==="LTD_BUSINESS")return!1;const r=e.company.member_limit-1;return e.company.current_member_count>=r}),i=I(()=>{if(g.value||e.company.subscription_type==="MAXI"||e.company.subscription_type==="BUSINESS"||e.company.subscription_type==="LTD_BUSINESS")return!1;const r=Math.floor(e.company.project_limit*.8);return e.company.current_project_count>=r}),l=()=>{y.value=!0,sessionStorage.setItem(`member-warning-dismissed-${e.company.id}`,"true")},_=()=>{g.value=!0,sessionStorage.setItem(`project-warning-dismissed-${e.company.id}`,"true")},h=()=>e.company.subscription_type==="FREE"?"Upgrade to MIDI (£6/month) or MAXI (£12/month) to add more members.":"Upgrade to MAXI (£12/month) to add more members.",d=()=>e.company.subscription_type==="FREE"?{before:"to create more projects.",hasLinks:!0}:{before:"to create more projects.",hasLinks:!0,singlePlan:"MAXI"};return(r,o)=>(p(),b("div",L,[n.value?(p(),b("div",V,[t("div",R,[a(s(M),{class:"w-5 h-5 text-red-600 dark:text-red-400"}),t("div",null,[t("div",q,[a(s(W),{class:"w-4 h-4 text-red-600 dark:text-red-400"}),o[0]||(o[0]=t("span",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Member Limit Warning ",-1))]),t("p",z,c(r.company.current_member_count)+"/"+c(r.company.member_limit)+" members used. "+c(h()),1)])]),t("button",{onClick:l,class:"p-1 hover:bg-red-100 dark:hover:bg-red-800/30 rounded transition-colors","aria-label":"Dismiss warning"},[a(s($),{class:"w-4 h-4 text-red-600 dark:text-red-400"})])])):w("",!0),i.value?(p(),b("div",{key:1,class:f(["flex items-center justify-between bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mx-4",{"mt-4":!n.value}]),role:"alert"},[t("div",O,[a(s(M),{class:"w-5 h-5 text-red-600 dark:text-red-400"}),t("div",null,[t("div",G,[a(s(X),{class:"w-4 h-4 text-red-600 dark:text-red-400"}),o[1]||(o[1]=t("span",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Project Limit Warning ",-1))]),t("p",H,[m(c(r.company.current_project_count)+"/"+c(r.company.project_limit)+" projects used. ",1),r.company.subscription_type==="FREE"?(p(),b(j,{key:0},[a(s(x),{href:"/subscription",class:"font-bold text-red-800 dark:text-red-200 hover:underline"},{default:v(()=>o[2]||(o[2]=[m(" Upgrade to MIDI (£6/month) ",-1)])),_:1,__:[2]}),o[4]||(o[4]=m(" or ",-1)),a(s(x),{href:"/subscription",class:"font-bold text-red-800 dark:text-red-200 hover:underline"},{default:v(()=>o[3]||(o[3]=[m(" MAXI (£12/month) ",-1)])),_:1,__:[3]}),m(" "+c(d().before),1)],64)):(p(),b(j,{key:1},[a(s(x),{href:"/subscription",class:"font-bold text-red-800 dark:text-red-200 hover:underline"},{default:v(()=>o[5]||(o[5]=[m(" Upgrade to MAXI (£12/month) ",-1)])),_:1,__:[5]}),m(" "+c(d().before),1)],64))])])]),t("button",{onClick:_,class:"p-1 hover:bg-red-100 dark:hover:bg-red-800/30 rounded transition-colors","aria-label":"Dismiss warning"},[a(s($),{class:"w-4 h-4 text-red-600 dark:text-red-400"})])],2)):w("",!0)]))}}),K=["title"],Q=["title"],Y=["title"],Z={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},ee={class:"lg:col-span-1 activity-feed-container"},te=C({__name:"Dashboard",props:{user:{},company:{}},setup(S){const{t:e}=A(),y=[{title:e("dashboard.title"),href:"/dashboard"}],g=u(null),n=u(!1),i=u(!1);u(!1);const l=u(!1),_=d=>{g.value=d?.color||null},h=()=>{l.value=!l.value};return(d,r)=>(p(),b(j,null,[a(s(U),{title:s(e)("dashboard.title")},null,8,["title"]),a(B,{breadcrumbs:y,company:d.company,"project-color":g.value},{dashboardActions:v(()=>[t("button",{onClick:r[0]||(r[0]=o=>i.value=!i.value),title:i.value?s(e)("dashboard.hide_calendar"):s(e)("dashboard.show_calendar"),class:f(["inline-flex items-center justify-center p-2 transition-colors",i.value?"text-blue-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"])},[a(k,{name:"Calendar",class:"w-5 h-5"})],10,K),t("button",{onClick:r[1]||(r[1]=o=>n.value=!n.value),title:n.value?s(e)("dashboard.hide_activity_feed"):s(e)("dashboard.show_activity_feed"),class:f(["inline-flex items-center justify-center p-2 transition-colors",n.value?"text-blue-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"])},[a(k,{name:"Activity",class:"w-5 h-5"})],10,Q),t("button",{onClick:h,title:l.value?s(e)("dashboard.exit_select_mode"):s(e)("dashboard.select_for_bulk_update"),class:f(["inline-flex items-center justify-center p-2 transition-colors",l.value?"text-blue-600 dark:text-blue-400":"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100"])},[a(k,{name:"CheckSquare",class:"w-5 h-5"})],10,Y)]),default:v(()=>[d.company?(p(),E(J,{key:0,company:d.company},null,8,["company"])):w("",!0),t("div",Z,[t("div",{class:f(["grid gap-4 h-full",n.value?"grid-cols-1 lg:grid-cols-4":"grid-cols-1"])},[t("div",{class:f(n.value?"lg:col-span-3":"col-span-1")},[a(F,{onProjectChanged:_,"show-activity-feed":n.value,"show-calendar":i.value,"is-select-mode":l.value,onToggleActivityFeed:r[2]||(r[2]=o=>n.value=!n.value),onToggleCalendar:r[3]||(r[3]=o=>i.value=!i.value),onToggleSelectMode:h},null,8,["show-activity-feed","show-calendar","is-select-mode"])],2),D(t("div",ee,[a(P,{"company-id":d.company?.id||1,visible:n.value,class:"h-full"},null,8,["company-id","visible"])],512),[[T,n.value]])],2)])]),_:1},8,["company","project-color"])],64))}}),_e=N(te,[["__scopeId","data-v-15d95b6b"]]);export{_e as default};
