import{d as b,a as p,o as l,n as f,A as t,L as y,r as K,c as R,f as a,K as V,q as o,b as r,p as v,e as w,g as _,t as g,F as C,j as A}from"./app-D26XIfzf.js";import{C as q,c as L,b as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-CFpy5i0u.js";import{c as x,_ as D}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ZvGvhEqX.js";import{C as j}from"./check-CLsr01bt.js";import"./useForwardExpose-u0QYPlbw.js";import"./index-C61bzdNy.js";const E=b({__name:"Card",props:{class:{}},setup(d){const i=d;return(n,c)=>(l(),p("div",{"data-slot":"card",class:f(t(x)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",i.class))},[y(n.$slots,"default")],2))}}),F=b({__name:"CardContent",props:{class:{}},setup(d){const i=d;return(n,c)=>(l(),p("div",{"data-slot":"card-content",class:f(t(x)("px-6",i.class))},[y(n.$slots,"default")],2))}}),I=b({__name:"CardDescription",props:{class:{}},setup(d){const i=d;return(n,c)=>(l(),p("p",{"data-slot":"card-description",class:f(t(x)("text-muted-foreground text-sm",i.class))},[y(n.$slots,"default")],2))}}),$=b({__name:"CardHeader",props:{class:{}},setup(d){const i=d;return(n,c)=>(l(),p("div",{"data-slot":"card-header",class:f(t(x)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",i.class))},[y(n.$slots,"default")],2))}}),S=b({__name:"CardTitle",props:{class:{}},setup(d){const i=d;return(n,c)=>(l(),p("h3",{"data-slot":"card-title",class:f(t(x)("leading-none font-semibold",i.class))},[y(n.$slots,"default")],2))}}),Y={class:"max-w-6xl mx-auto p-6"},z={class:"flex items-center justify-between"},H={class:"text-lg font-semibold"},J={class:"text-gray-600 dark:text-gray-400"},U={key:0,class:"mt-2"},Z={class:"text-sm text-gray-500"},G={class:"flex items-center gap-2"},Q={class:"mb-8"},T={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},W={class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},ee={class:"text-sm text-gray-500"},te={class:"space-y-2 mb-6"},se={key:1,class:"text-center"},ie=b({__name:"Index",props:{user:{},company:{},plans:{},stripePublicKey:{}},setup(d){const i=d,n=K(!1),c=R(()=>i.company?.subscription_type||"FREE"),h=R(()=>i.company?.subscription_status==="active"),P=s=>`Â£${(s/100).toFixed(0)}`,N=s=>{switch(s){case"FREE":return"gray";case"MIDI":return"blue";case"MAXI":return"purple";default:return"gray"}},M=s=>{const e=N(s);return s===c.value?`border-2 border-${e}-500 bg-${e}-50 dark:bg-${e}-900/20`:"border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"},O=async s=>{if(!(n.value||s===c.value)){n.value=!0;try{const u=await(await fetch("/subscription/change-plan",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({plan:s})})).json();u.checkout_url?window.location.href=u.checkout_url:u.message?window.location.reload():u.error&&alert(u.error)}catch(e){console.error("Error changing plan:",e),alert("An error occurred while changing your plan. Please try again.")}finally{n.value=!1}}},B=async()=>{if(confirm("Are you sure you want to cancel your subscription? Your account will be downgraded to the FREE plan.")){n.value=!0;try{const e=await(await fetch("/subscription/cancel-subscription",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).json();e.message?window.location.reload():e.error&&alert(e.error)}catch(s){console.error("Error cancelling subscription:",s),alert("An error occurred while cancelling your subscription. Please try again.")}finally{n.value=!1}}};return(s,e)=>(l(),p(C,null,[a(t(V),{title:"Subscription Management"}),a(X,null,{default:o(()=>[r("div",Y,[e[7]||(e[7]=r("div",{class:"mb-8"},[r("h1",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2"}," Subscription Management "),r("p",{class:"text-gray-600 dark:text-gray-400"}," Manage your TaskIT subscription and billing settings ")],-1)),a(t(E),{class:"mb-8"},{default:o(()=>[a(t($),null,{default:o(()=>[a(t(S),{class:"flex items-center gap-2"},{default:o(()=>[a(t(q),{class:"w-5 h-5"}),e[0]||(e[0]=_(" Current Subscription ",-1))]),_:1,__:[0]})]),_:1}),a(t(F),null,{default:o(()=>[r("div",z,[r("div",null,[r("p",H,g(s.plans[c.value].name),1),r("p",J,g(c.value==="FREE"?"Free forever":`${P(s.plans[c.value].price)} per month`),1),s.company?.subscription_ends_at?(l(),p("div",U,[r("p",Z,g(h.value?"Renews on":"Expires on")+": "+g(new Date(s.company.subscription_ends_at).toLocaleDateString()),1)])):w("",!0)]),r("div",G,[r("div",{class:f(["px-3 py-1 rounded-full text-sm font-medium",{"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300":h.value,"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300":s.company?.subscription_status==="past_due","bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300":s.company?.subscription_status==="canceled","bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300":c.value==="FREE"}])},g(h.value?"Active":s.company?.subscription_status||"Free"),3)])])]),_:1})]),_:1}),r("div",Q,[e[2]||(e[2]=r("h2",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6"}," Available Plans ",-1)),r("div",T,[(l(!0),p(C,null,A(s.plans,(u,m)=>(l(),v(t(E),{key:m,class:f(M(m))},{default:o(()=>[a(t($),{class:"text-center"},{default:o(()=>[a(t(S),{class:"flex items-center justify-center gap-2"},{default:o(()=>[_(g(u.name)+" ",1),m===c.value?(l(),v(t(j),{key:0,class:"w-5 h-5 text-green-500"})):w("",!0)]),_:2},1024),a(t(I),null,{default:o(()=>[r("div",W,g(m==="FREE"?"Free":P(u.price)),1),r("div",ee,g(m==="FREE"?"Forever":"per month"),1)]),_:2},1024)]),_:2},1024),a(t(F),null,{default:o(()=>[r("ul",te,[(l(!0),p(C,null,A(u.features,k=>(l(),p("li",{key:k,class:"flex items-start gap-2 text-sm"},[a(t(j),{class:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),r("span",null,g(k),1)]))),128))]),m!==c.value?(l(),v(t(D),{key:0,onClick:k=>O(m),disabled:n.value,variant:m==="MIDI"?"default":"outline",class:"w-full"},{default:o(()=>[_(g(m==="FREE"?"Downgrade to Free":`Upgrade to ${u.name}`),1)]),_:2},1032,["onClick","disabled","variant"])):(l(),p("div",se,e[1]||(e[1]=[r("span",{class:"text-sm text-gray-500"},"Current Plan",-1)])))]),_:2},1024)]),_:2},1032,["class"]))),128))])]),c.value!=="FREE"&&s.company?.stripe_subscription_id?(l(),v(t(E),{key:0,class:"border-red-200 dark:border-red-800"},{default:o(()=>[a(t($),null,{default:o(()=>[a(t(S),{class:"flex items-center gap-2 text-red-600 dark:text-red-400"},{default:o(()=>[a(t(L),{class:"w-5 h-5"}),e[3]||(e[3]=_(" Danger Zone ",-1))]),_:1,__:[3]}),a(t(I),null,{default:o(()=>e[4]||(e[4]=[_(" Cancel your subscription and downgrade to the FREE plan ",-1)])),_:1,__:[4]})]),_:1}),a(t(F),null,{default:o(()=>[a(t(D),{onClick:B,disabled:n.value,variant:"destructive"},{default:o(()=>e[5]||(e[5]=[_(" Cancel Subscription ",-1)])),_:1,__:[5]},8,["disabled"]),e[6]||(e[6]=r("p",{class:"text-xs text-gray-500 mt-2"}," Your subscription will remain active until the end of your current billing period. ",-1))]),_:1,__:[6]})]),_:1})):w("",!0)])]),_:1})],64))}});export{ie as default};
