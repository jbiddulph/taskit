import{d as re,A as ne,B as _,u as B,k as p,c as i,o,a as t,b as a,h as de,w as l,e as s,i as c,m as w,t as r,j as d,F as J,r as ie,s as $,p as j}from"./app-DHN43dZH.js";import{_ as C}from"./index-D5jQmbZY.js";import{_ as g,c as b,a as P,b as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-qjvibs25.js";import{_ as D}from"./CardDescription.vue_vue_type_script_setup_true_lang-7dkyNeJz.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-Drxe1V1b.js";import{_ as M}from"./Label.vue_vue_type_script_setup_true_lang-BI4WaQpC.js";import{_ as ue}from"./AppLayout.vue_vue_type_script_setup_true_lang-BdVPORX7.js";import{_ as ce}from"./Layout.vue_vue_type_script_setup_true_lang-m5zDcZ9_.js";import{I as V,E as G,f as me,U as pe,g as ge,h as be}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-BuS1BrCC.js";import{C as K}from"./lock-qEwQ3Hcd.js";import{G as N}from"./globe-B449sJ6C.js";import{C as W}from"./users-vtPaCUhs.js";import"./useForwardExpose-Bz_XTCS1.js";import"./Heading.vue_vue_type_script_setup_true_lang-CJ422rlg.js";import"./index-8O20627j.js";import"./index-CMWG4mbA.js";import"./index-ObrdfWFb.js";import"./Presence-D_B8ZtS4.js";import"./check-Dm_jYxSf.js";import"./x-ERjZ9viU.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DI3sQZJU.js";const fe={class:"space-y-6"},_e={key:0,class:"mb-6"},ye={class:"flex items-center gap-2 text-amber-700 dark:text-amber-300"},ve={key:1,class:"mb-6"},xe={class:"flex items-center gap-2 text-green-700 dark:text-green-300"},ke={class:"text-sm font-medium"},he={key:2,class:"mb-6"},we={class:"flex items-center gap-2 text-red-700 dark:text-red-300"},Ce={class:"text-sm font-medium"},Pe={key:3,class:"mb-6"},Se={class:"space-y-3"},Ae={class:"text-sm text-blue-700 dark:text-blue-300"},Le={class:"font-medium mb-2"},Fe={class:"list-decimal list-inside space-y-1"},Ie={class:"mt-4"},Te={key:0,class:"text-sm text-red-600 dark:text-red-400"},Ee={key:1,class:"space-y-2 text-sm"},Ue={class:"flex items-center gap-2"},$e={key:0,class:"text-xs text-gray-500"},je={class:"flex items-center gap-2"},De={key:0,class:"text-xs text-gray-500"},Ne={key:1,class:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg"},ze={class:"flex items-center gap-2 text-green-700 dark:text-green-300 mb-2"},Be={class:"flex items-center gap-2"},Me=["href"],Ve={key:2,class:"p-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg"},Ge={class:"flex items-center gap-2 text-gray-600 dark:text-gray-400"},Re={key:3},Ze={class:"space-y-4"},Ye={class:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg"},qe={class:"flex items-center gap-3"},He={class:"flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded border"},Je=["src","alt"],Xe={key:1,class:"flex items-center gap-1 text-xs font-bold text-blue-600 dark:text-blue-400"},Ke={class:"font-medium text-gray-900 dark:text-gray-100"},We={class:"text-sm text-gray-600 dark:text-gray-400"},Oe={class:"flex items-start gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},Qe={class:"text-sm text-blue-700 dark:text-blue-300"},es={class:"space-y-1 text-xs"},ss={key:0,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},as={class:"flex-1"},ts={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ls={class:"text-xs text-gray-600 dark:text-gray-400"},os={class:"flex items-center justify-between"},rs={class:"space-y-1"},ns={key:0,class:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg"},ds={class:"flex items-center gap-2 text-green-700 dark:text-green-300 mb-2"},is={class:"space-y-2"},us={class:"flex items-center gap-2"},cs=["href"],ms={class:"flex items-center gap-2"},ps=["href"],js=re({__name:"Company",props:{user:{},company:{}},setup(O){const m=O,R=ne(),k=_(()=>m.company&&["MIDI","MAXI"].includes(m.company.subscription_type)),Q=B({}),A=B({company_name:m.company?.name||""}),y=B({is_public:m.company?.is_public||!1}),z=p(),L=p(!1),F=p(!1),h=p(!1),f=p(null),v=p(""),I=p(""),T=p(!1),u=p(null),ee=n=>{const e=n.target;e.files&&e.files[0]&&(f.value=e.files[0],v.value="")},se=async()=>{if(!(!f.value||!m.company)){L.value=!0,v.value="";try{const n=await be(f.value,m.company.name,m.company.code);j.post("/settings/company-logo/update-url",{logo_url:n},{onSuccess:()=>{f.value=null,z.value&&(z.value.value=""),j.reload()},onError:e=>{v.value=e.logo||"Failed to update logo URL"}})}catch(n){console.error("Logo upload failed:",n),v.value="Failed to upload logo to storage. Please try again."}finally{L.value=!1}}},ae=()=>{F.value=!0,Q.delete("/settings/company-logo/remove",{onFinish:()=>{F.value=!1}})},te=()=>{m.company&&(h.value=!0,I.value="",A.post("/settings/company/subdomain",{onSuccess:()=>{h.value=!1,j.reload()},onError:n=>{h.value=!1,I.value=n.subdomain||"Failed to create subdomain"}}))},le=async()=>{T.value=!0,u.value=null;try{const e=await(await fetch("/settings/company/api-permissions")).json();u.value=e}catch(n){console.error("Error checking API permissions:",n),u.value={error:"Failed to check API permissions"}}finally{T.value=!1}},oe=()=>{y.patch("/settings/company/public",{onSuccess:()=>{j.reload()},onError:n=>{console.error("Failed to update public dashboard setting:",n)}})},x=_(()=>R.props.errors||{}),Z=_(()=>R.props.flash?.success||""),Y=_(()=>m.company?.logo_url),E=_(()=>!!Y.value),q=_(()=>!!m.company?.subdomain),H=_(()=>m.company?.subdomain_url);return(n,e)=>(o(),i(J,null,[t(a(de),{title:"Company Settings"}),t(ue,null,{default:l(()=>[t(ce,null,{default:l(()=>[s("div",fe,[e[30]||(e[30]=s("div",null,[s("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"Company Settings"),s("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Manage your company's branding and subdomain. ")],-1)),k.value?c("",!0):(o(),i("div",_e,[t(a(g),{class:"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20"},{default:l(()=>[t(a(b),{class:"p-4"},{default:l(()=>[s("div",ye,[t(a(K),{class:"w-5 h-5 flex-shrink-0"}),e[1]||(e[1]=s("div",null,[s("p",{class:"font-medium"},"Upgrade Required"),s("p",{class:"text-sm"},"Company features are available for MIDI and MAXI plans only.")],-1))])]),_:1})]),_:1})])),Z.value?(o(),i("div",ve,[t(a(g),{class:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20"},{default:l(()=>[t(a(b),{class:"p-4"},{default:l(()=>[s("div",xe,[t(a(V),{class:"w-5 h-5 flex-shrink-0"}),s("p",ke,r(Z.value),1)])]),_:1})]),_:1})])):c("",!0),x.value.logo||v.value||I.value?(o(),i("div",he,[t(a(g),{class:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20"},{default:l(()=>[t(a(b),{class:"p-4"},{default:l(()=>[s("div",we,[t(a(K),{class:"w-5 h-5 flex-shrink-0"}),s("p",Ce,r(x.value.logo||v.value||I.value),1)])]),_:1})]),_:1})])):c("",!0),x.value.instructions?(o(),i("div",Pe,[t(a(g),{class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20"},{default:l(()=>[t(a(P),null,{default:l(()=>[t(a(S),{class:"text-blue-700 dark:text-blue-300"},{default:l(()=>[d(r(x.value.instructions.title),1)]),_:1})]),_:1}),t(a(b),null,{default:l(()=>[s("div",Se,[s("div",Ae,[s("p",Le,r(x.value.instructions.note),1),s("ol",Fe,[(o(!0),i(J,null,ie(x.value.instructions.steps,U=>(o(),i("li",{key:U},r(U),1))),128))])])])]),_:1})]),_:1})])):c("",!0),k.value?(o(),w(a(g),{key:4},{default:l(()=>[t(a(P),null,{default:l(()=>[t(a(S),{class:"flex items-center gap-2"},{default:l(()=>[t(a(N),{class:"w-5 h-5"}),e[2]||(e[2]=d(" Company Subdomain ",-1))]),_:1,__:[2]}),t(a(D),null,{default:l(()=>e[3]||(e[3]=[d(" Create a custom subdomain for your company using Cloudflare DNS and Heroku. This will allow guests to access your company's dashboard directly. ",-1)])),_:1,__:[3]}),s("div",Ie,[t(a(C),{onClick:le,disabled:T.value,variant:"outline",size:"sm"},{default:l(()=>[d(r(T.value?"Checking...":"Check API Permissions"),1)]),_:1},8,["disabled"])])]),_:1}),t(a(b),{class:"space-y-4"},{default:l(()=>[u.value?(o(),i("div",{key:0,class:$(["p-4 border rounded-lg",{"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":!u.value.error,"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":u.value.error}])},[s("div",{class:$(["flex items-center gap-2 mb-2",{"text-green-700 dark:text-green-300":!u.value.error,"text-red-700 dark:text-red-300":u.value.error}])},[t(a(V),{class:"w-5 h-5"}),e[4]||(e[4]=s("span",{class:"font-medium"},"API Permissions Status",-1))],2),u.value.error?(o(),i("div",Te,r(u.value.error),1)):(o(),i("div",Ee,[s("div",Ue,[e[5]||(e[5]=s("span",{class:"font-medium"},"Cloudflare API:",-1)),s("span",{class:$(u.value.cloudflare_api?.accessible?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},r(u.value.cloudflare_api?.accessible?"✓ Accessible":"✗ Not Accessible"),3),u.value.cloudflare_api?.accessible?c("",!0):(o(),i("span",$e," ("+r(u.value.cloudflare_api?.message)+") ",1))]),s("div",je,[e[6]||(e[6]=s("span",{class:"font-medium"},"Heroku API:",-1)),s("span",{class:$(u.value.heroku_api?.accessible?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},r(u.value.heroku_api?.accessible?"✓ Accessible":"✗ Not Accessible"),3),u.value.heroku_api?.accessible?c("",!0):(o(),i("span",De," ("+r(u.value.heroku_api?.message)+") ",1))])]))],2)):c("",!0),q.value?(o(),i("div",Ne,[s("div",ze,[t(a(W),{class:"w-5 h-5"}),e[7]||(e[7]=s("span",{class:"font-medium"},"Subdomain Active",-1))]),s("div",Be,[e[8]||(e[8]=s("span",{class:"text-sm text-green-600 dark:text-green-400"}," Your company subdomain: ",-1)),s("a",{href:H.value,target:"_blank",class:"inline-flex items-center gap-1 text-sm font-medium text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300"},[d(r(H.value)+" ",1),t(a(G),{class:"w-3 h-3"})],8,Me)])])):c("",!0),q.value?(o(),i("div",Ve,[s("div",Ge,[t(a(N),{class:"w-5 h-5"}),e[9]||(e[9]=s("span",{class:"font-medium"},"Sub Domain Linked",-1))]),e[10]||(e[10]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Your company subdomain is already active and linked. ",-1))])):(o(),i("div",Re,[s("div",Ze,[s("div",null,[t(a(M),{for:"company-name",class:"text-sm font-medium"},{default:l(()=>e[11]||(e[11]=[d(" Company Name ",-1)])),_:1,__:[11]}),t(a(X),{id:"company-name",modelValue:a(A).company_name,"onUpdate:modelValue":e[0]||(e[0]=U=>a(A).company_name=U),type:"text",placeholder:"Enter your company name",class:"mt-1"},null,8,["modelValue"]),e[12]||(e[12]=s("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},' This will be converted to a subdomain (e.g., "My Company" → "my-company.zaptask.co.uk") ',-1))]),t(a(C),{onClick:te,disabled:h.value||!a(A).company_name,class:"w-full"},{default:l(()=>[t(a(N),{class:"w-4 h-4 mr-2"}),d(" "+r(h.value?"Creating Subdomain...":"Create Company Subdomain"),1)]),_:1},8,["disabled"])])]))]),_:1})]),_:1})):c("",!0),k.value?(o(),w(a(g),{key:5},{default:l(()=>[t(a(P),null,{default:l(()=>[t(a(S),null,{default:l(()=>e[13]||(e[13]=[d("Current Logo",-1)])),_:1,__:[13]}),t(a(D),null,{default:l(()=>e[14]||(e[14]=[d(" This is how your logo currently appears in the application. ",-1)])),_:1,__:[14]})]),_:1}),t(a(b),null,{default:l(()=>[s("div",Ye,[s("div",qe,[s("div",He,[E.value?(o(),i("img",{key:0,src:Y.value,alt:n.company?.name+" logo",class:"object-contain"},null,8,Je)):(o(),i("div",Xe,e[15]||(e[15]=[s("div",{class:"w-6 h-6 bg-blue-600 dark:bg-blue-400 rounded text-white dark:text-gray-900 flex items-center justify-center"},[s("img",{src:"/zap_icon.png",alt:"ZapTask",class:"w-4 h-4 dark:hidden"}),s("img",{src:"/zap_icon_white.svg",alt:"ZapTask",class:"w-4 h-4 hidden dark:block"})],-1),s("span",null,"ZapTask",-1)])))]),s("div",null,[s("p",Ke,r(E.value?"Custom Logo":"Default ZapTask Logo"),1),s("p",We,r(E.value?"Your company's custom logo":"Standard ZapTask branding"),1)])]),E.value?(o(),w(a(C),{key:0,onClick:ae,disabled:F.value,variant:"outline",class:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300"},{default:l(()=>[t(a(me),{class:"w-4 h-4 mr-2"}),d(" "+r(F.value?"Removing...":"Remove Logo"),1)]),_:1},8,["disabled"])):c("",!0)])]),_:1})]),_:1})):c("",!0),k.value?(o(),w(a(g),{key:6},{default:l(()=>[t(a(P),null,{default:l(()=>[t(a(S),{class:"flex items-center gap-2"},{default:l(()=>[t(a(pe),{class:"w-5 h-5"}),e[16]||(e[16]=d(" Upload New Logo ",-1))]),_:1,__:[16]}),t(a(D),null,{default:l(()=>e[17]||(e[17]=[d(" Upload a custom logo for your company. The logo will replace the ZapTask branding. ",-1)])),_:1,__:[17]})]),_:1}),t(a(b),{class:"space-y-4"},{default:l(()=>[s("div",Oe,[t(a(V),{class:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),s("div",Qe,[e[21]||(e[21]=s("p",{class:"font-medium mb-1"},"Logo Requirements:",-1)),s("ul",es,[e[18]||(e[18]=s("li",null,"• Recommended size: 216px width × 48px height",-1)),e[19]||(e[19]=s("li",null,"• Supported formats: PNG, JPG, JPEG, SVG",-1)),e[20]||(e[20]=s("li",null,"• Maximum file size: 2MB",-1)),s("li",null,"• Filename will be: "+r(n.company?.name?.replace(/\s+/g,"_"))+"_"+r(n.company?.code)+"_timestamp",1)])])]),s("div",null,[t(a(M),{for:"logo-upload",class:"text-sm font-medium"},{default:l(()=>e[22]||(e[22]=[d(" Select Logo File ",-1)])),_:1,__:[22]}),t(a(X),{id:"logo-upload",ref_key:"fileInput",ref:z,type:"file",accept:"image/png,image/jpg,image/jpeg,image/svg+xml",onChange:ee,class:"mt-1"},null,512)]),f.value?(o(),i("div",ss,[t(a(ge),{class:"w-5 h-5 text-gray-600 dark:text-gray-400"}),s("div",as,[s("p",ts,r(f.value.name),1),s("p",ls,r((f.value.size/1024).toFixed(1))+" KB ",1)]),t(a(C),{onClick:se,disabled:L.value,class:"ml-auto"},{default:l(()=>[d(r(L.value?"Uploading...":"Upload Logo"),1)]),_:1},8,["disabled"])])):c("",!0)]),_:1})]),_:1})):c("",!0),k.value?(o(),w(a(g),{key:7},{default:l(()=>[t(a(P),null,{default:l(()=>[t(a(S),{class:"flex items-center gap-2"},{default:l(()=>[t(a(N),{class:"w-5 h-5"}),e[23]||(e[23]=d(" Public Dashboard ",-1))]),_:1,__:[23]}),t(a(D),null,{default:l(()=>e[24]||(e[24]=[d(" Allow guests to view your company's dashboard without logging in. They can see projects and todos but cannot create, edit, or delete anything. ",-1)])),_:1,__:[24]})]),_:1}),t(a(b),{class:"space-y-4"},{default:l(()=>[s("div",os,[s("div",rs,[t(a(M),{class:"text-sm font-medium"},{default:l(()=>e[25]||(e[25]=[d("Enable Public Dashboard",-1)])),_:1,__:[25]}),e[26]||(e[26]=s("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," When enabled, anyone can view your dashboard at your subdomain without logging in. ",-1))]),t(a(C),{onClick:oe,disabled:a(y).processing,variant:a(y).is_public?"default":"outline",size:"sm"},{default:l(()=>[d(r(a(y).processing?"Updating...":a(y).is_public?"Enabled":"Enable"),1)]),_:1},8,["disabled","variant"])]),a(y).is_public&&n.company?.subdomain_url?(o(),i("div",ns,[s("div",ds,[t(a(W),{class:"w-5 h-5"}),e[27]||(e[27]=s("span",{class:"font-medium"},"Public Dashboard Active",-1))]),s("div",is,[s("div",us,[e[28]||(e[28]=s("span",{class:"text-sm text-green-600 dark:text-green-400"}," Company page: ",-1)),s("a",{href:n.company.subdomain_url,target:"_blank",class:"inline-flex items-center gap-1 text-sm font-medium text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300"},[d(r(n.company.subdomain_url)+" ",1),t(a(G),{class:"w-3 h-3"})],8,cs)]),s("div",ms,[e[29]||(e[29]=s("span",{class:"text-sm text-green-600 dark:text-green-400"}," Public dashboard: ",-1)),s("a",{href:`${n.company.subdomain_url}/public`,target:"_blank",class:"inline-flex items-center gap-1 text-sm font-medium text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300"},[d(r(n.company.subdomain_url)+"/public ",1),t(a(G),{class:"w-3 h-3"})],8,ps)])])])):c("",!0)]),_:1})]),_:1})):c("",!0)])]),_:1})]),_:1})],64))}});export{js as default};
