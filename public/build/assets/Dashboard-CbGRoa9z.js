import{_ as h,a as G,t as D,b as ne}from"./AppLayout.vue_vue_type_script_setup_true_lang-DwixK0xA.js";import{d as de}from"./index-C61bzdNy.js";import{d as U,c as u,o as d,a as e,b as j,n as Q,t as b,w as S,e as y,F as I,r as V,f as k,g as Y,h as W,T as ie,i as z,j as H,k as x,v as T,l as E,m as J,p as ue,q as K,s as X,u as Z,x as ce,y as ge}from"./app-ATqtT2x2.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B2cB7CiQ.js";import"./useForwardExpose-MuLAqm1Z.js";import"./check-QgHpFreb.js";const pe={class:"flex items-start justify-between mb-2"},fe={class:"flex items-center gap-2"},ye={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},be={class:"font-medium text-gray-900 dark:text-gray-100 mb-2 line-clamp-2"},me={key:0,class:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2"},ve={key:1,class:"flex flex-wrap gap-1 mb-3"},xe={class:"flex items-center justify-between text-sm"},we={class:"flex items-center gap-2"},ke={key:0,class:"w-6 h-6 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white text-xs font-medium"},he={key:1,class:"text-gray-400"},$e={class:"flex items-center gap-1 text-gray-500"},_e={key:0},je={key:1},Te={key:2,class:"absolute top-2 right-2"},Ce={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 dark:bg-gray-700 text-xs font-medium text-gray-700 dark:text-gray-300"},Pe=U({__name:"TodoCard",props:{todo:{}},emits:["edit","delete"],setup(P,{emit:g}){const c=P,v=g,p={Low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-yellow-200",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",High:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",Critical:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};let r=!1;const m=()=>{r||v("edit",c.todo),r=!1},f=i=>{const $=new Date(i),_=new Date,C=$.getTime()-_.getTime(),s=Math.ceil(C/(1e3*60*60*24));return s<0?`${Math.abs(s)}d overdue`:s===0?"Today":s===1?"Tomorrow":s<=7?`${s}d`:$.toLocaleDateString()};return(i,$)=>(d(),u("div",{class:"group relative bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:m},[e("div",pe,[e("div",fe,[e("span",{class:Q(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",p[i.todo.priority]])},b(i.todo.priority),3),i.todo.type?(d(),u("span",ye,b(i.todo.type),1)):j("",!0)]),e("button",{onClick:$[0]||($[0]=S(_=>i.$emit("delete",i.todo.id),["stop"])),class:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500 transition-opacity"},[y(h,{name:"Trash2",class:"w-4 h-4"})])]),e("h3",be,b(i.todo.title),1),i.todo.description?(d(),u("p",me,b(i.todo.description),1)):j("",!0),i.todo.tags&&i.todo.tags.length?(d(),u("div",ve,[(d(!0),u(I,null,V(i.todo.tags,_=>(d(),u("span",{key:_,class:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},b(_),1))),128))])):j("",!0),e("div",xe,[e("div",we,[i.todo.assignee?(d(),u("div",ke,b(i.todo.assignee.charAt(0).toUpperCase()),1)):(d(),u("span",he,"Unassigned"))]),e("div",$e,[y(h,{name:"Calendar",class:"w-4 h-4"}),i.todo.due_date?(d(),u("span",_e,b(f(i.todo.due_date)),1)):(d(),u("span",je,"No due date"))])]),i.todo.story_points?(d(),u("div",Te,[e("span",Ce,b(i.todo.story_points),1)])):j("",!0)]))}}),De=G(Pe,[["__scopeId","data-v-6bce560b"]]),Ee={class:"flex flex-col h-full min-w-80"},Se={class:"flex items-center justify-between mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Fe={class:"flex items-center gap-2"},Ie={class:"font-semibold text-gray-900 dark:text-gray-100"},Ue={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-600 text-xs font-medium text-gray-700 dark:text-gray-300"},Ve={class:"flex items-center gap-2"},Ae={key:0,class:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400"},Le={key:1,class:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 border-2 border-blue-300 rounded-lg flex items-center justify-center pointer-events-none"},Me=["onDragstart"],Be=U({__name:"TodoColumn",props:{title:{},status:{},todos:{},showAddButton:{type:Boolean,default:!1}},emits:["add","edit","delete","menu","drop"],setup(P,{emit:g}){const c=P,v=g,p=k(),r=k(!1),m=k(null),f=(s,o)=>{console.log("Drag start:",o.title,"Status:",o.status,"Column:",c.status),s.dataTransfer&&(s.dataTransfer.effectAllowed="move",s.dataTransfer.setData("text/plain",o.id),s.dataTransfer.setData("application/json",JSON.stringify(o)),m.value=o,console.log("Set draggedTodo:",m.value?.title))},i=()=>{console.log("Drag end in column:",c.status,"draggedTodo:",m.value?.title),m.value&&m.value.status===c.status&&(console.log("Clearing draggedTodo in source column:",c.status),m.value=null)},$=s=>{s.preventDefault(),s.stopPropagation(),s.dataTransfer&&(s.dataTransfer.dropEffect="move"),r.value=!0,console.log("Drag over column:",c.status,"isDragOver:",r.value)},_=s=>{console.log("Drag leave column:",c.status),s.currentTarget===p.value&&(r.value=!1)},C=s=>{console.log("Drop event triggered in column:",c.status),s.preventDefault(),s.stopPropagation(),r.value=!1;const o=s.dataTransfer?.getData("text/plain"),l=s.dataTransfer?.getData("application/json");if(console.log("Drop dataTransfer todoId:",o,"todoJson:",l),l)try{const w=JSON.parse(l);console.log("Parsed todo from dataTransfer:",w.title,"Status:",w.status),w.status!==c.status?(console.log("Emitting drop event:",w.title,"->",c.status),v("drop",w,c.status)):console.log("Cannot drop to same status")}catch(w){console.error("Failed to parse todo from dataTransfer:",w)}else console.log("No todo data in dataTransfer")};return(s,o)=>(d(),u("div",Ee,[e("div",Se,[e("div",Fe,[e("h3",Ie,b(s.title),1),e("span",Ue,b(s.todos.length),1)]),e("div",Ve,[s.showAddButton?(d(),u("button",{key:0,onClick:o[0]||(o[0]=l=>s.$emit("add")),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},[y(h,{name:"Plus",class:"w-4 h-4"})])):j("",!0),e("button",{onClick:o[1]||(o[1]=l=>s.$emit("menu")),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},[y(h,{name:"MoreHorizontal",class:"w-4 h-4"})])])]),e("div",{ref_key:"dropZone",ref:p,class:Q(["flex-1 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-700 min-h-[400px] transition-colors relative",{"border-blue-300 bg-blue-50 dark:bg-blue-900/20":r.value,"border-gray-200 dark:border-gray-700":!r.value}]),onDragover:S($,["prevent"]),onDragleave:_,onDrop:C,onDragenter:o[4]||(o[4]=S(()=>{},["prevent"]))},[s.todos.length===0?(d(),u("div",Ae,[y(h,{name:"Inbox",class:"w-12 h-12 mb-2 opacity-50"}),o[5]||(o[5]=e("p",{class:"text-sm text-center"},"No todos yet",-1)),o[6]||(o[6]=e("p",{class:"text-xs text-center opacity-75"},"Drag and drop here or click + to add",-1))])):j("",!0),r.value?(d(),u("div",Le,o[7]||(o[7]=[e("div",{class:"text-blue-600 dark:text-blue-300 text-lg font-medium"}," Drop here to move todo ",-1)]))):(d(),Y(ie,{key:2,name:"todo-list",tag:"div",class:"space-y-3"},{default:W(()=>[(d(!0),u(I,null,V(s.todos,l=>(d(),u("div",{key:l.id,draggable:"true",onDragstart:w=>f(w,l),onDragend:i,class:"transform transition-transform duration-200 hover:scale-[1.02]"},[y(De,{todo:l,onEdit:o[2]||(o[2]=w=>s.$emit("edit",w)),onDelete:o[3]||(o[3]=w=>s.$emit("delete",w))},null,8,["todo"])],40,Me))),128))]),_:1}))],34)]))}}),O=G(Be,[["__scopeId","data-v-93fb1086"]]),Ne={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},qe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Oe={class:"p-6"},ze={class:"flex items-center justify-between mb-6"},He={class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},Je=["value","selected"],Ke={class:"grid grid-cols-2 gap-4"},Xe={class:"grid grid-cols-2 gap-4"},Re={class:"grid grid-cols-2 gap-4"},Ze=["onKeydown"],Ge={key:0,class:"flex flex-wrap gap-2"},Qe=["onClick"],Ye={class:"flex justify-end gap-3 pt-4"},We={type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"},et=U({__name:"TodoForm",props:{todo:{},isEditing:{type:Boolean,default:!1},currentProject:{}},emits:["close","save"],setup(P,{emit:g}){const c=P,v=g,p=k([]),r=k({id:"",project_id:"",title:"",description:"",priority:"Medium",type:"",tags:[],assignee:"",due_date:"",story_points:void 0,status:"todo"}),m=k(""),f=async()=>{try{p.value=await D.getProjects()}catch(s){console.error("Failed to load projects:",s)}},i=()=>{r.value={id:"",project_id:"",title:"",description:"",priority:"Medium",type:"",tags:[],assignee:"",due_date:"",story_points:void 0,status:"todo"},m.value=""};z(()=>{f()}),H(()=>c.todo,s=>{s?r.value={...s}:(i(),c.currentProject&&(r.value.project_id=c.currentProject.id.toString()))},{immediate:!0});const $=()=>{const s=m.value.trim();s&&!r.value.tags?.includes(s)&&(r.value.tags||(r.value.tags=[]),r.value.tags.push(s),m.value="")},_=s=>{r.value.tags&&(r.value.tags=r.value.tags.filter(o=>o!==s))},C=async()=>{try{const s={...r.value,project_id:parseInt(r.value.project_id),due_date:r.value.due_date||null,story_points:r.value.story_points||null};c.isEditing&&(s.id=parseInt(r.value.id)),v("save",s),i()}catch(s){console.error("Failed to submit todo:",s)}};return(s,o)=>(d(),u("div",Ne,[e("div",qe,[e("div",Oe,[e("div",ze,[e("h2",He,b(s.isEditing?"Edit Todo":"Add New Todo"),1),e("button",{onClick:o[0]||(o[0]=l=>s.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[y(h,{name:"X",class:"w-6 h-6"})])]),e("form",{onSubmit:S(C,["prevent"]),class:"space-y-4"},[e("div",null,[o[12]||(o[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title * ",-1)),x(e("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>r.value.title=l),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter todo title"},null,512),[[T,r.value.title]])]),e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description ",-1)),x(e("textarea",{"onUpdate:modelValue":o[2]||(o[2]=l=>r.value.description=l),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter description (optional)"},null,512),[[T,r.value.description]])]),e("div",null,[o[15]||(o[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project * ",-1)),x(e("select",{"onUpdate:modelValue":o[3]||(o[3]=l=>r.value.project_id=l),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[o[14]||(o[14]=e("option",{value:""},"Select Project",-1)),(d(!0),u(I,null,V(p.value,l=>(d(),u("option",{key:l.id,value:l.id,selected:!s.isEditing&&s.currentProject&&l.id===s.currentProject.id},b(l.key)+" - "+b(l.name),9,Je))),128))],512),[[E,r.value.project_id]])]),e("div",Ke,[e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Priority * ",-1)),x(e("select",{"onUpdate:modelValue":o[4]||(o[4]=l=>r.value.priority=l),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},o[16]||(o[16]=[e("option",{value:"Low"},"Low",-1),e("option",{value:"Medium"},"Medium",-1),e("option",{value:"High"},"High",-1),e("option",{value:"Critical"},"Critical",-1)]),512),[[E,r.value.priority]])]),e("div",null,[o[19]||(o[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Type ",-1)),x(e("select",{"onUpdate:modelValue":o[5]||(o[5]=l=>r.value.type=l),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},o[18]||(o[18]=[J('<option value="">Select type</option><option value="Bug">Bug</option><option value="Feature">Feature</option><option value="Task">Task</option><option value="Story">Story</option><option value="Epic">Epic</option>',6)]),512),[[E,r.value.type]])])]),e("div",Xe,[e("div",null,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Assignee ",-1)),x(e("input",{"onUpdate:modelValue":o[6]||(o[6]=l=>r.value.assignee=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter assignee name"},null,512),[[T,r.value.assignee]])]),e("div",null,[o[21]||(o[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Due Date ",-1)),x(e("input",{"onUpdate:modelValue":o[7]||(o[7]=l=>r.value.due_date=l),type:"date",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,512),[[T,r.value.due_date]])])]),e("div",Re,[e("div",null,[o[22]||(o[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Story Points ",-1)),x(e("input",{"onUpdate:modelValue":o[8]||(o[8]=l=>r.value.story_points=l),type:"number",min:"1",max:"21",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"1-21"},null,512),[[T,r.value.story_points,void 0,{number:!0}]])]),e("div",null,[o[23]||(o[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Tags ",-1)),x(e("input",{"onUpdate:modelValue":o[9]||(o[9]=l=>m.value=l),type:"text",onKeydown:ue(S($,["prevent"]),["enter"]),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Type and press Enter to add tags"},null,40,Ze),[[T,m.value]])])]),r.value.tags&&r.value.tags.length>0?(d(),u("div",Ge,[(d(!0),u(I,null,V(r.value.tags,l=>(d(),u("span",{key:l,class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},[K(b(l)+" ",1),e("button",{type:"button",onClick:w=>_(l),class:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200"},[y(h,{name:"X",class:"w-3 h-3"})],8,Qe)]))),128))])):j("",!0),e("div",null,[o[25]||(o[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Status * ",-1)),x(e("select",{"onUpdate:modelValue":o[10]||(o[10]=l=>r.value.status=l),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},o[24]||(o[24]=[e("option",{value:"todo"},"To Do",-1),e("option",{value:"in-progress"},"In Progress",-1),e("option",{value:"done"},"Done",-1)]),512),[[E,r.value.status]])]),e("div",Ye,[e("button",{type:"button",onClick:o[11]||(o[11]=l=>s.$emit("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Cancel "),e("button",We,b(s.isEditing?"Update":"Create"),1)])],32)])])]))}}),tt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},ot={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},rt={class:"flex items-center"},st={class:"flex-shrink-0"},at={class:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center"},lt={class:"ml-4"},nt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},dt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},it={class:"flex items-center"},ut={class:"flex-shrink-0"},ct={class:"w-8 h-8 bg-yellow-100 dark:bg-yellow-900 rounded-lg flex items-center justify-center"},gt={class:"ml-4"},pt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},ft={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},yt={class:"flex items-center"},bt={class:"flex-shrink-0"},mt={class:"w-8 h-8 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center"},vt={class:"ml-4"},xt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},wt={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4"},kt={class:"flex items-center"},ht={class:"flex-shrink-0"},$t={class:"w-8 h-8 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center"},_t={class:"ml-4"},jt={class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},Tt=U({__name:"TodoStats",props:{todos:{}},setup(P){const g=P,c=X(()=>{const v=new Date,p=new Date(v.getFullYear(),v.getMonth(),v.getDate()),r=g.todos.filter(f=>f.due_date?new Date(f.due_date)<p&&f.status!=="done":!1).length,m=g.todos.filter(f=>f.due_date?new Date(f.due_date).getTime()===p.getTime():!1).length;return{total:g.todos.length,todo:g.todos.filter(f=>f.status==="todo").length,inProgress:g.todos.filter(f=>f.status==="in-progress").length,done:g.todos.filter(f=>f.status==="done").length,overdue:r,dueToday:m}});return(v,p)=>(d(),u("div",tt,[e("div",ot,[e("div",rt,[e("div",st,[e("div",at,[y(h,{name:"List",class:"w-5 h-5 text-blue-600 dark:text-blue-400"})])]),e("div",lt,[p[0]||(p[0]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Todos",-1)),e("p",nt,b(c.value.total),1)])])]),e("div",dt,[e("div",it,[e("div",ut,[e("div",ct,[y(h,{name:"Clock",class:"w-5 h-5 text-yellow-600 dark:text-yellow-400"})])]),e("div",gt,[p[1]||(p[1]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"In Progress",-1)),e("p",pt,b(c.value.inProgress),1)])])]),e("div",ft,[e("div",yt,[e("div",bt,[e("div",mt,[y(h,{name:"CheckCircle",class:"w-5 h-5 text-green-600 dark:text-green-400"})])]),e("div",vt,[p[2]||(p[2]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Completed",-1)),e("p",xt,b(c.value.done),1)])])]),e("div",wt,[e("div",kt,[e("div",ht,[e("div",$t,[y(h,{name:"AlertTriangle",class:"w-5 h-5 text-red-600 dark:text-red-400"})])]),e("div",_t,[p[3]||(p[3]=e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Overdue",-1)),e("p",jt,b(c.value.overdue),1)])])])]))}}),Ct={class:"h-full flex flex-col"},Pt={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},Dt={class:"flex-1"},Et={class:"flex items-center gap-3 mb-2"},St={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Ft={class:"text-gray-600 dark:text-gray-400"},It={key:0,class:"mt-4"},Ut={class:"flex items-center gap-3"},Vt={class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600"},At={class:"text-sm"},Lt={class:"font-medium text-gray-900 dark:text-gray-100"},Mt={key:0,class:"text-xs text-gray-500"},Bt=["disabled"],Nt={class:"mt-4 flex flex-col lg:flex-row gap-4"},qt={class:"flex-1 relative"},Ot={class:"flex gap-2"},zt=["value"],Ht={class:"flex-1 flex gap-6 overflow-x-auto pb-4"},Jt={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Kt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full"},Xt={class:"p-6"},Rt={class:"flex items-center justify-between mb-6"},Zt={class:"flex items-center gap-3"},Gt={class:"text-sm text-gray-600 dark:text-gray-400"},Qt={class:"flex gap-3 pt-4"},Yt={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Wt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full"},eo={class:"p-6"},to={class:"flex items-center justify-between mb-6"},oo={class:"flex gap-3 pt-4"},ro=U({__name:"TodoBoard",setup(P){const g=k([]),c=k(!1),v=k(!1),p=k(!1),r=k(null),m=k(null),f=k(""),i=k(""),$=k(""),_=k(""),C=k(""),s=k({name:"",description:"",key:"",color:"#3B82F6"}),o=X(()=>{let a=g.value.filter(t=>{const n=!i.value||t.title.toLowerCase().includes(i.value.toLowerCase())||t.description?.toLowerCase().includes(i.value.toLowerCase())||t.tags?.some(le=>le.toLowerCase().includes(i.value.toLowerCase())),F=!$.value||t.priority===$.value,q=!_.value||t.type===_.value,ae=!C.value||t.assignee===C.value;return n&&F&&q&&ae});return{todo:a.filter(t=>t.status==="todo"),inProgress:a.filter(t=>t.status==="in-progress"),done:a.filter(t=>t.status==="done")}}),l=X(()=>{const a=g.value.map(t=>t.assignee).filter(Boolean);return[...new Set(a)]}),w=a=>{m.value={...a},c.value=!0},ee=async a=>{try{if(!r.value){window.$notify&&window.$notify({type:"error",title:"Project Required",message:"Please select a project first before creating a todo."});return}if(m.value){const t=await D.updateTodo(a.id,a),n=g.value.findIndex(F=>F.id===a.id);n!==-1&&(g.value[n]=t),m.value=null,window.$notify&&window.$notify({type:"success",title:"Todo Updated",message:`Todo "${t.title}" has been updated successfully.`})}else{const t=await D.createTodo({...a,project_id:r.value.id});g.value.push(t),window.$notify&&window.$notify({type:"success",title:"Todo Created",message:`Todo "${t.title}" has been created successfully.`})}c.value=!1,window.dispatchEvent(new CustomEvent("projectCreated")),window.dispatchEvent(new CustomEvent("todoChanged"))}catch(t){console.error("Failed to save todo:",t),window.$notify&&window.$notify({type:"error",title:"Save Failed",message:"Failed to save todo. Please try again."})}},A=async a=>{const t=g.value.find(n=>n.id===a);if(t&&confirm(`Are you sure you want to delete "${t.title}"?

This action cannot be undone.`))try{await D.deleteTodo(a),g.value=g.value.filter(n=>n.id!==a),window.dispatchEvent(new CustomEvent("todoChanged")),window.$notify&&window.$notify({type:"success",title:"Todo Deleted",message:`Todo "${t.title}" has been deleted successfully.`})}catch(n){console.error("Failed to delete todo:",n),window.$notify&&window.$notify({type:"error",title:"Delete Failed",message:"Failed to delete todo. Please try again."})}},L=async(a,t)=>{console.log("TodoBoard received drop event:",a.title,"->",t);try{const n=await D.updateTodoStatus(a.id,t);console.log("API response:",n);const F=g.value.findIndex(q=>q.id===a.id);F!==-1&&(g.value[F]=n,console.log("Todo updated in local state"),window.dispatchEvent(new CustomEvent("todoChanged")),window.$notify&&window.$notify({type:"success",title:"Status Updated",message:`Todo "${n.title}" moved to ${t.replace("-"," ")}.`}))}catch(n){console.error("Failed to update todo status:",n),window.$notify&&window.$notify({type:"error",title:"Update Failed",message:"Failed to update todo status. Please try again."})}},te=()=>{c.value=!1,m.value=null},R=()=>{if(!r.value){window.$notify&&window.$notify({type:"warning",title:"Project Required",message:"Please select a project first before creating a todo."});return}c.value=!0},oe=()=>{r.value&&(f.value=r.value.name,p.value=!0)},re=async()=>{if(!(!r.value||!f.value.trim()))try{const a=await D.updateProject(r.value.id,{name:f.value.trim()});r.value={...r.value,...a},window.$notify&&window.$notify({type:"success",title:"Project Updated",message:`Project "${a.name}" has been updated successfully.`}),p.value=!1,f.value="",window.dispatchEvent(new CustomEvent("todoChanged")),console.log("Project updated successfully:",a.name)}catch(a){console.error("Failed to update project:",a),window.$notify&&window.$notify({type:"error",title:"Update Failed",message:"Failed to update project. Please try again."})}},M=()=>{s.value={name:"",description:"",key:"",color:"#3B82F6"}},se=async()=>{try{const a={name:s.value.name,description:s.value.description||void 0,key:s.value.key||void 0,color:s.value.color},t=await D.createProject(a);r.value=t,localStorage.setItem("currentProjectId",t.id.toString()),v.value=!1,M(),await N(),window.dispatchEvent(new CustomEvent("projectCreated")),window.dispatchEvent(new CustomEvent("todoChanged")),window.$notify&&window.$notify({type:"success",title:"Project Created",message:`Project "${t.name}" has been created successfully.`}),console.log("Project created successfully:",t.name)}catch(a){console.error("Failed to create project:",a),window.$notify&&window.$notify({type:"error",title:"Creation Failed",message:"Failed to create project. Please try again."})}};z(async()=>{await B(),await N()});const B=async()=>{try{const a=localStorage.getItem("currentProjectId");if(a){const t=await D.getProject(parseInt(a));r.value=t}}catch(a){console.error("Failed to load current project:",a),localStorage.removeItem("currentProjectId")}},N=async()=>{try{const a={};r.value&&(a.project_id=r.value.id);const t=await D.getTodos(a);g.value=t.data.todo.concat(t.data["in-progress"]).concat(t.data.done)}catch(a){console.error("Failed to load todos:",a)}};return H(r,async()=>{await N()}),H(v,a=>{a&&M()}),z(()=>{const a=t=>{t.key==="currentProjectId"&&B()};window.addEventListener("storage",a),window.addEventListener("projectSelected",async t=>{t.detail?.projectId&&(localStorage.setItem("currentProjectId",t.detail.projectId.toString()),await B())}),window.addEventListener("openCreateProjectModal",()=>{v.value=!0,M()})}),(a,t)=>(d(),u("div",Ct,[e("div",{class:"mb-6 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 relative overflow-hidden",style:Z(r.value?{borderTop:`4px solid ${r.value.color}`,backgroundColor:`${r.value.color}10`}:{})},[e("div",Pt,[e("div",Dt,[e("div",Et,[e("h1",St,b(r.value?r.value.name:"Todo Board"),1),r.value?(d(),u("button",{key:0,onClick:oe,class:"p-1 text-gray-400 hover:text-blue-500 transition-colors",title:"Edit project name"},[y(h,{name:"Edit3",class:"w-5 h-5"})])):j("",!0)]),e("p",Ft,b(r.value?`Project: ${r.value.key} - ${r.value.description||"No description"}`:"Select a project to manage todos"),1),r.value?j("",!0):(d(),u("div",It,[e("button",{onClick:t[0]||(t[0]=n=>v.value=!0),class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"},[y(h,{name:"Plus",class:"w-4 h-4"}),t[14]||(t[14]=K(" Create Project ",-1))])]))]),e("div",Ut,[e("div",Vt,[r.value?(d(),u("div",{key:0,class:"w-4 h-4 rounded-full",style:Z({backgroundColor:r.value.color})},null,4)):j("",!0),e("div",At,[e("div",Lt,b(r.value?.name||"Select a Project"),1),r.value?(d(),u("div",Mt,b(r.value.key),1)):j("",!0)])]),e("button",{onClick:R,disabled:!r.value,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[y(h,{name:"Plus",class:"w-4 h-4"}),t[15]||(t[15]=K(" Add Todo ",-1))],8,Bt)])]),e("div",Nt,[e("div",qt,[y(h,{name:"Search",class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>i.value=n),type:"text",placeholder:"Search todos...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},null,512),[[T,i.value]])]),e("div",Ot,[x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>$.value=n),class:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},t[16]||(t[16]=[J('<option value="">All Priorities</option><option value="Low">Low</option><option value="Medium">Medium</option><option value="High">High</option><option value="Critical">Critical</option>',5)]),512),[[E,$.value]]),x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=n=>_.value=n),class:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},t[17]||(t[17]=[J('<option value="">All Types</option><option value="Bug">Bug</option><option value="Feature">Feature</option><option value="Task">Task</option><option value="Story">Story</option><option value="Epic">Epic</option>',6)]),512),[[E,_.value]]),x(e("select",{"onUpdate:modelValue":t[4]||(t[4]=n=>C.value=n),class:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900"},[t[18]||(t[18]=e("option",{value:""},"All Assignees",-1)),(d(!0),u(I,null,V(l.value,n=>(d(),u("option",{key:n,value:n},b(n),9,zt))),128))],512),[[E,C.value]])])])],4),y(Tt,{todos:g.value},null,8,["todos"]),e("div",Ht,[y(O,{title:"To Do",status:"todo",todos:o.value.todo,"show-add-button":!0,onAdd:R,onEdit:w,onDelete:A,onDrop:L,onMenu:()=>{}},null,8,["todos"]),y(O,{title:"In Progress",status:"in-progress",todos:o.value.inProgress,onEdit:w,onDelete:A,onDrop:L,onMenu:()=>{}},null,8,["todos"]),y(O,{title:"Done",status:"done",todos:o.value.done,onEdit:w,onDelete:A,onDrop:L,onMenu:()=>{}},null,8,["todos"])]),c.value?(d(),Y(et,{key:0,todo:m.value,"is-editing":!!m.value,"current-project":r.value,onClose:te,onSave:ee},null,8,["todo","is-editing","current-project"])):j("",!0),v.value?(d(),u("div",Jt,[e("div",Kt,[e("div",Xt,[e("div",Rt,[t[19]||(t[19]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},"Create New Project",-1)),e("button",{onClick:t[5]||(t[5]=n=>v.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[y(h,{name:"X",class:"w-6 h-6"})])]),e("form",{onSubmit:S(se,["prevent"]),class:"space-y-4"},[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project Name * ",-1)),x(e("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>s.value.name=n),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project name"},null,512),[[T,s.value.name]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description (Optional) ",-1)),x(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=n=>s.value.description=n),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project description"},null,512),[[T,s.value.description]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project Key (Optional) ",-1)),x(e("input",{"onUpdate:modelValue":t[8]||(t[8]=n=>s.value.key=n),type:"text",maxlength:"10",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., PROJ, FEAT"},null,512),[[T,s.value.key]]),t[23]||(t[23]=e("p",{class:"text-sm text-gray-500 mt-1"},"Leave empty to auto-generate",-1))]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Color ",-1)),e("div",Zt,[x(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>s.value.color=n),type:"color",class:"w-12 h-10 border border-gray-300 dark:border-gray-600 rounded-md cursor-pointer"},null,512),[[T,s.value.color]]),e("span",Gt,b(s.value.color),1)])]),e("div",Qt,[t[25]||(t[25]=e("button",{type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Create Project ",-1)),e("button",{type:"button",onClick:t[10]||(t[10]=n=>v.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"}," Cancel ")])],32)])])])):j("",!0),p.value?(d(),u("div",Yt,[e("div",Wt,[e("div",eo,[e("div",to,[t[26]||(t[26]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},"Edit Project",-1)),e("button",{onClick:t[11]||(t[11]=n=>p.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[y(h,{name:"X",class:"w-6 h-6"})])]),e("form",{onSubmit:S(re,["prevent"]),class:"space-y-4"},[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Project Name * ",-1)),x(e("input",{"onUpdate:modelValue":t[12]||(t[12]=n=>f.value=n),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project name"},null,512),[[T,f.value]])]),e("div",oo,[t[28]||(t[28]=e("button",{type:"submit",class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Save Changes ",-1)),e("button",{type:"button",onClick:t[13]||(t[13]=n=>p.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"}," Cancel ")])],32)])])])):j("",!0)]))}}),so={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},go=U({__name:"Dashboard",setup(P){const g=[{title:"Dashboard",href:de().url}];return(c,v)=>(d(),u(I,null,[y(ce(ge),{title:"Dashboard"}),y(ne,{breadcrumbs:g},{default:W(()=>[e("div",so,[y(ro)])]),_:1})],64))}});export{go as default};
