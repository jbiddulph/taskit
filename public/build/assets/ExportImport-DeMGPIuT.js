import{d as Q,E as Y,u as j,r as w,A as F,c as m,o as p,a as s,b as o,h as Z,w as l,e,i as c,p as ee,t as n,j as d,f as M,g as N,F as h,k as B,z as T}from"./app-CQW_W4yp.js";import{_ as J}from"./index-Ccpe21w4.js";import{_ as k,a as E,b as S,c as C}from"./CardTitle.vue_vue_type_script_setup_true_lang-DMH2VgBM.js";import{_ as P}from"./CardDescription.vue_vue_type_script_setup_true_lang-DT9pD6xz.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-B62o7SHF.js";import{_ as te,a as oe}from"./Layout.vue_vue_type_script_setup_true_lang-CpXxu9dT.js";import{_ as se}from"./Input.vue_vue_type_script_setup_true_lang-B1PPsvHW.js";import{_ as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-CVhIgV9p.js";import{D as O,l as b,P as U,m as R,F as ae,i as z}from"./realtimeService-PKhKZ4zC.js";import{C as V}from"./lock-5xXNlEFq.js";import{F as A}from"./x-KxSGEsYC.js";import"./useForwardExpose-DM4oe_MV.js";import"./Heading.vue_vue_type_script_setup_true_lang-Dp20cP-z.js";import"./index-8O20627j.js";import"./index-CMWG4mbA.js";import"./index-ObrdfWFb.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-mxSP_6Gp.js";import"./Presence-Cm_2zhuz.js";import"./VisuallyHidden-YQcxkrT_.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DuowDp8S.js";import"./check-C_4eNlsu.js";import"./globe-CCcjr67M.js";import"./loader-circle-C4oNokvD.js";const re={class:"space-y-6"},ne={key:0,class:"rounded-md bg-green-50 p-4 border border-green-200"},ie={class:"flex"},de={class:"ml-3"},pe={class:"text-sm font-medium text-green-800"},ue={key:1,class:"rounded-md bg-blue-50 p-4 border border-blue-200"},me={class:"flex"},ce={class:"flex-shrink-0"},fe={class:"ml-3"},ye={class:"text-sm font-medium text-blue-800"},_e={class:"ml-auto pl-3"},ve={key:2,class:"rounded-md bg-red-50 p-4 border border-red-200"},xe={class:"flex"},be={class:"flex-shrink-0"},ge={class:"ml-3"},we={class:"text-sm font-medium text-red-800"},he={class:"ml-auto pl-3"},ke={class:"space-y-2"},Ee=["value"],Se={key:0,class:"text-sm text-red-600"},Ce={class:"space-y-2"},Oe={class:"flex h-9 w-full rounded-md border border-input bg-gray-50 px-3 py-1 text-sm items-center"},De={class:"rounded-md bg-yellow-50 p-4 border border-yellow-200"},$e={class:"flex"},Ie={class:"flex-shrink-0"},Le={class:"space-y-2"},je=["value"],Fe={key:0,class:"text-sm text-red-600"},Me={class:"space-y-2"},Ne={key:0,class:"text-sm text-red-600"},Be={class:"grid grid-cols-1 gap-x-4 gap-y-2 sm:grid-cols-2 text-sm"},Te={class:"font-mono"},it=Q({__name:"ExportImport",props:{user:{},company:{}},setup(Je){const D=Y(),i=j({data_type:"",format:"json"}),u=j({file:null,import_type:""}),g=w(),y=w(""),_=w(""),q=async()=>{if(!(!i.data_type||!i.format)){i.processing=!0,y.value="",_.value="";try{const r=await fetch("/settings/export",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({data_type:i.data_type,format:i.format})});if(r.ok){const t=r.headers.get("Content-Disposition");let a=`export.${i.format}`;if(t){const L=t.match(/filename="(.+)"/);L&&(a=L[1])}const K=await r.blob(),I=window.URL.createObjectURL(K),v=document.createElement("a");v.href=I,v.download=a,document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(I),y.value=`âœ… ${a} downloaded successfully!`,i.reset()}else throw await r.text(),new Error(`Export failed: ${r.status} ${r.statusText}`)}catch(r){console.error("Export error:",r),_.value=`Failed to download export: ${r.message}`}finally{i.processing=!1}}},W=r=>{const t=r.target;t.files&&t.files.length>0&&(u.file=t.files[0])},X=()=>{u.post("/settings/import",{preserveScroll:!0,onSuccess:()=>{u.reset(),g.value&&(g.value.value="")}})},f=F(()=>D.props.errors||{}),$=F(()=>D.props.flash?.success||""),G=[{value:"all",label:"All Data",icon:b,description:"Export everything: company, projects, todos, and comments"},{value:"company",label:"Company Only",icon:b,description:"Export only company information"},{value:"projects",label:"Projects Only",icon:A,description:"Export only project information"},{value:"todos",label:"Todos Only",icon:U,description:"Export only todo/task information"},{value:"comments",label:"Comments Only",icon:R,description:"Export only comment information"}],H=[{value:"all",label:"All Data",icon:b,description:"Import everything: company, projects, todos, and comments"},{value:"company",label:"Company Only",icon:b,description:"Import company data only"},{value:"projects",label:"Projects Only",icon:A,description:"Import project data only"},{value:"todos",label:"Todos Only",icon:U,description:"Import todo/task data only"},{value:"comments",label:"Comments Only",icon:R,description:"Import comment data only"}];return(r,t)=>(p(),m(h,null,[s(o(Z),{title:"Export & Import"}),s(le,null,{default:l(()=>[s(te,null,{default:l(()=>[e("div",re,[t[26]||(t[26]=e("div",null,[e("h3",{class:"text-lg font-medium"},"Export & Import"),e("p",{class:"text-sm text-muted-foreground"}," Export your company data for backup or analysis, and import data from external sources. ")],-1)),s(o(oe)),$.value?(p(),m("div",ne,[e("div",ie,[t[4]||(t[4]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",de,[e("p",pe,n($.value),1)])])])):c("",!0),y.value?(p(),m("div",ue,[e("div",me,[e("div",ce,[s(o(O),{class:"h-5 w-5 text-blue-400"})]),e("div",fe,[e("p",ye,n(y.value),1)]),e("div",_e,[e("button",{onClick:t[0]||(t[0]=a=>y.value=""),class:"text-blue-400 hover:text-blue-600"},t[5]||(t[5]=[e("span",{class:"sr-only"},"Dismiss",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):c("",!0),_.value?(p(),m("div",ve,[e("div",xe,[e("div",be,[s(o(V),{class:"h-5 w-5 text-red-400"})]),e("div",ge,[e("p",we,n(_.value),1)]),e("div",he,[e("button",{onClick:t[1]||(t[1]=a=>_.value=""),class:"text-red-400 hover:text-red-600"},t[6]||(t[6]=[e("span",{class:"sr-only"},"Dismiss",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):c("",!0),s(o(k),null,{default:l(()=>[s(o(E),null,{default:l(()=>[s(o(S),{class:"flex items-center gap-2"},{default:l(()=>[s(o(O),{class:"h-5 w-5 text-blue-600"}),t[7]||(t[7]=d(" Export Data ",-1))]),_:1,__:[7]}),s(o(P),null,{default:l(()=>t[8]||(t[8]=[d(" Download your company data in JSON format for backup and easy restoration. ",-1)])),_:1,__:[8]})]),_:1}),s(o(C),{class:"space-y-6"},{default:l(()=>[e("form",{onSubmit:M(q,["prevent"]),class:"space-y-4"},[e("div",ke,[s(o(x),{for:"data_type"},{default:l(()=>t[9]||(t[9]=[d("What data would you like to export?",-1)])),_:1,__:[9]}),N(e("select",{id:"data_type",name:"data_type","onUpdate:modelValue":t[2]||(t[2]=a=>o(i).data_type=a),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},[t[10]||(t[10]=e("option",{value:""},"Select data type...",-1)),(p(),m(h,null,B(G,a=>e("option",{key:a.value,value:a.value},n(a.label)+" - "+n(a.description),9,Ee)),64))],512),[[T,o(i).data_type]]),f.value.data_type?(p(),m("p",Se,n(f.value.data_type),1)):c("",!0)]),e("div",Ce,[s(o(x),null,{default:l(()=>t[11]||(t[11]=[d("Export format",-1)])),_:1,__:[11]}),e("div",Oe,[s(o(ae),{class:"h-4 w-4 mr-2 text-blue-600"}),t[12]||(t[12]=e("span",null,"JSON Format - Structured data format, perfect for backup and restore",-1))]),t[13]||(t[13]=e("p",{class:"text-xs text-muted-foreground"},"JSON is the only supported format for reliable data backup and restoration.",-1))]),s(o(J),{type:"submit",disabled:o(i).processing||!o(i).data_type,class:"w-full"},{default:l(()=>[s(o(O),{class:"mr-2 h-4 w-4"}),d(" "+n(o(i).processing?"Preparing Export...":"Export Data"),1)]),_:1},8,["disabled"])],32)]),_:1})]),_:1}),s(o(k),null,{default:l(()=>[s(o(E),null,{default:l(()=>[s(o(S),{class:"flex items-center gap-2"},{default:l(()=>[s(o(z),{class:"h-5 w-5 text-green-600"}),t[14]||(t[14]=d(" Import Data ",-1))]),_:1,__:[14]}),s(o(P),null,{default:l(()=>t[15]||(t[15]=[d(" Upload a JSON file to restore data into your company workspace. ",-1)])),_:1,__:[15]})]),_:1}),s(o(C),{class:"space-y-6"},{default:l(()=>[e("div",De,[e("div",$e,[e("div",Ie,[s(o(V),{class:"h-5 w-5 text-yellow-400"})]),t[16]||(t[16]=e("div",{class:"ml-3"},[e("h4",{class:"text-sm font-medium text-yellow-800"},"Import Guidelines"),e("div",{class:"mt-2 text-sm text-yellow-700"},[e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Only JSON format files are supported for import"),e("li",null,"Data will be restored to your current company workspace"),e("li",null,"Existing data with matching IDs may be updated"),e("li",null,"Maximum file size: 10MB"),e("li",null,"Perfect for restoring deleted or lost data")])])],-1))])]),e("form",{onSubmit:M(X,["prevent"]),class:"space-y-4"},[e("div",Le,[s(o(x),{for:"import_type"},{default:l(()=>t[17]||(t[17]=[d("What type of data are you importing?",-1)])),_:1,__:[17]}),N(e("select",{id:"import_type",name:"import_type","onUpdate:modelValue":t[3]||(t[3]=a=>o(u).import_type=a),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},[t[18]||(t[18]=e("option",{value:""},"Select import type...",-1)),(p(),m(h,null,B(H,a=>e("option",{key:a.value,value:a.value},n(a.label)+" - "+n(a.description),9,je)),64))],512),[[T,o(u).import_type]]),f.value.import_type?(p(),m("p",Fe,n(f.value.import_type),1)):c("",!0)]),e("div",Me,[s(o(x),{for:"file"},{default:l(()=>t[19]||(t[19]=[d("Select file to import",-1)])),_:1,__:[19]}),s(o(se),{ref_key:"fileInput",ref:g,type:"file",accept:".json",onChange:W,class:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,512),t[20]||(t[20]=e("p",{class:"text-xs text-muted-foreground"}," Supported format: JSON only (max 10MB) ",-1)),f.value.file?(p(),m("p",Ne,n(f.value.file),1)):c("",!0)]),s(o(J),{type:"submit",disabled:o(u).processing||!o(u).file||!o(u).import_type,class:"w-full"},{default:l(()=>[s(o(z),{class:"mr-2 h-4 w-4"}),d(" "+n(o(u).processing?"Importing...":"Import Data"),1)]),_:1},8,["disabled"])],32)]),_:1})]),_:1}),r.company?(p(),ee(o(k),{key:3},{default:l(()=>[s(o(E),null,{default:l(()=>[s(o(S),{class:"text-sm"},{default:l(()=>t[21]||(t[21]=[d("Export Information",-1)])),_:1,__:[21]})]),_:1}),s(o(C),null,{default:l(()=>[e("dl",Be,[e("div",null,[t[22]||(t[22]=e("dt",{class:"font-medium text-muted-foreground"},"Company",-1)),e("dd",null,n(r.company.name),1)]),e("div",null,[t[23]||(t[23]=e("dt",{class:"font-medium text-muted-foreground"},"Company Code",-1)),e("dd",Te,n(r.company.code),1)]),e("div",null,[t[24]||(t[24]=e("dt",{class:"font-medium text-muted-foreground"},"Subscription",-1)),e("dd",null,n(r.company.subscription_type),1)]),e("div",null,[t[25]||(t[25]=e("dt",{class:"font-medium text-muted-foreground"},"Exported by",-1)),e("dd",null,n(r.user.name)+" ("+n(r.user.email)+")",1)])])]),_:1})]),_:1})):c("",!0)])]),_:1})]),_:1})],64))}});export{it as default};
