import{d as ae,G as te,A as f,u as Z,k as p,c as d,o as l,a as t,b as a,h as oe,w as o,e,i as m,m as P,t as r,j as u,F as Y,r as le,s as F,p as $}from"./app-DpDEmlsT.js";import{_ as T}from"./index-Cae3Zw8P.js";import{_ as b,c as _,a as U,b as E}from"./CardTitle.vue_vue_type_script_setup_true_lang-CS1skZJl.js";import{_ as M}from"./CardDescription.vue_vue_type_script_setup_true_lang-B9rIcoYP.js";import{_ as q}from"./Input.vue_vue_type_script_setup_true_lang-D321YJTu.js";import{_ as J}from"./Label.vue_vue_type_script_setup_true_lang-B0m5XPVx.js";import{_ as re}from"./AppLayout.vue_vue_type_script_setup_true_lang-D6VWUjTt.js";import{_ as ne}from"./Layout.vue_vue_type_script_setup_true_lang-a32ez0OA.js";import{I as j,E as de,f as ie,U as ue,g as me,h as ce}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-Cxs9WfE-.js";import{C as X}from"./lock-DGbQbhPw.js";import{G as z}from"./globe-Dcqpe7_f.js";import{C as pe}from"./users-D5VdZ70O.js";import"./useForwardExpose-B1r30wiX.js";import"./Heading.vue_vue_type_script_setup_true_lang-G_DbSKUo.js";import"./index-8O20627j.js";import"./index-CMWG4mbA.js";import"./index-ObrdfWFb.js";import"./check-7StFLzsz.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BtVrGi_f.js";const ge={class:"space-y-6"},fe={key:0,class:"mb-6"},be={class:"flex items-center gap-2 text-amber-700 dark:text-amber-300"},_e={key:1,class:"mb-6"},ve={class:"flex items-center gap-2 text-green-700 dark:text-green-300"},ye={class:"text-sm font-medium"},xe={key:2,class:"mb-6"},ke={class:"flex items-center gap-2 text-red-700 dark:text-red-300"},he={class:"text-sm font-medium"},we={key:3,class:"mb-6"},Ce={class:"space-y-3"},Se={class:"text-sm text-blue-700 dark:text-blue-300"},Le={class:"font-medium mb-2"},Ae={class:"list-decimal list-inside space-y-1"},Ie={class:"mt-4"},Pe={key:0,class:"text-sm text-red-600 dark:text-red-400"},Fe={key:1,class:"space-y-2 text-sm"},Te={class:"flex items-center gap-2"},Ue={key:0,class:"text-xs text-gray-500"},Ee={class:"flex items-center gap-2"},Ne={key:0,class:"text-xs text-gray-500"},$e={key:1,class:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg"},Me={class:"flex items-center gap-2 text-green-700 dark:text-green-300 mb-2"},je={class:"flex items-center gap-2"},ze=["href"],Be={key:2,class:"p-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg"},Ve={class:"flex items-center gap-2 text-gray-600 dark:text-gray-400"},De={key:3},Ge={class:"space-y-4"},Re={class:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg"},Ze={class:"flex items-center gap-3"},Ye={class:"flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded border"},qe=["src","alt"],Je={key:1,class:"flex items-center gap-1 text-xs font-bold text-blue-600 dark:text-blue-400"},Xe={class:"font-medium text-gray-900 dark:text-gray-100"},Ke={class:"text-sm text-gray-600 dark:text-gray-400"},He={class:"flex items-start gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},Oe={class:"text-sm text-blue-700 dark:text-blue-300"},Qe={class:"space-y-1 text-xs"},We={key:0,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},es={class:"flex-1"},ss={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},as={class:"text-xs text-gray-600 dark:text-gray-400"},hs=ae({__name:"Company",props:{user:{},company:{}},setup(K){const c=K,B=te(),k=f(()=>c.company&&["MIDI","MAXI"].includes(c.company.subscription_type)),H=Z({}),h=Z({company_name:c.company?.name||""}),N=p(),w=p(!1),C=p(!1),x=p(!1),g=p(null),v=p(""),S=p(""),L=p(!1),n=p(null),O=i=>{const s=i.target;s.files&&s.files[0]&&(g.value=s.files[0],v.value="")},Q=async()=>{if(!(!g.value||!c.company)){w.value=!0,v.value="";try{const i=await ce(g.value,c.company.name,c.company.code);$.post("/settings/company-logo/update-url",{logo_url:i},{onSuccess:()=>{g.value=null,N.value&&(N.value.value=""),$.reload()},onError:s=>{v.value=s.logo||"Failed to update logo URL"}})}catch(i){console.error("Logo upload failed:",i),v.value="Failed to upload logo to storage. Please try again."}finally{w.value=!1}}},W=()=>{C.value=!0,H.delete("/settings/company-logo/remove",{onFinish:()=>{C.value=!1}})},ee=()=>{c.company&&(x.value=!0,S.value="",h.post("/settings/company/subdomain",{onSuccess:()=>{x.value=!1,$.reload()},onError:i=>{x.value=!1,S.value=i.subdomain||"Failed to create subdomain"}}))},se=async()=>{L.value=!0,n.value=null;try{const s=await(await fetch("/settings/company/api-permissions")).json();n.value=s}catch(i){console.error("Error checking API permissions:",i),n.value={error:"Failed to check API permissions"}}finally{L.value=!1}},y=f(()=>B.props.errors||{}),V=f(()=>B.props.flash?.success||""),D=f(()=>c.company?.logo_url),A=f(()=>!!D.value),G=f(()=>!!c.company?.subdomain),R=f(()=>c.company?.subdomain_url);return(i,s)=>(l(),d(Y,null,[t(a(oe),{title:"Company Settings"}),t(re,null,{default:o(()=>[t(ne,null,{default:o(()=>[e("div",ge,[s[23]||(s[23]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"Company Settings"),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Manage your company's branding and subdomain. ")],-1)),k.value?m("",!0):(l(),d("div",fe,[t(a(b),{class:"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20"},{default:o(()=>[t(a(_),{class:"p-4"},{default:o(()=>[e("div",be,[t(a(X),{class:"w-5 h-5 flex-shrink-0"}),s[1]||(s[1]=e("div",null,[e("p",{class:"font-medium"},"Upgrade Required"),e("p",{class:"text-sm"},"Company features are available for MIDI and MAXI plans only.")],-1))])]),_:1})]),_:1})])),V.value?(l(),d("div",_e,[t(a(b),{class:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20"},{default:o(()=>[t(a(_),{class:"p-4"},{default:o(()=>[e("div",ve,[t(a(j),{class:"w-5 h-5 flex-shrink-0"}),e("p",ye,r(V.value),1)])]),_:1})]),_:1})])):m("",!0),y.value.logo||v.value||S.value?(l(),d("div",xe,[t(a(b),{class:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20"},{default:o(()=>[t(a(_),{class:"p-4"},{default:o(()=>[e("div",ke,[t(a(X),{class:"w-5 h-5 flex-shrink-0"}),e("p",he,r(y.value.logo||v.value||S.value),1)])]),_:1})]),_:1})])):m("",!0),y.value.instructions?(l(),d("div",we,[t(a(b),{class:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20"},{default:o(()=>[t(a(U),null,{default:o(()=>[t(a(E),{class:"text-blue-700 dark:text-blue-300"},{default:o(()=>[u(r(y.value.instructions.title),1)]),_:1})]),_:1}),t(a(_),null,{default:o(()=>[e("div",Ce,[e("div",Se,[e("p",Le,r(y.value.instructions.note),1),e("ol",Ae,[(l(!0),d(Y,null,le(y.value.instructions.steps,I=>(l(),d("li",{key:I},r(I),1))),128))])])])]),_:1})]),_:1})])):m("",!0),k.value?(l(),P(a(b),{key:4},{default:o(()=>[t(a(U),null,{default:o(()=>[t(a(E),{class:"flex items-center gap-2"},{default:o(()=>[t(a(z),{class:"w-5 h-5"}),s[2]||(s[2]=u(" Company Subdomain ",-1))]),_:1,__:[2]}),t(a(M),null,{default:o(()=>s[3]||(s[3]=[u(" Create a custom subdomain for your company. This will allow guests to access your company's dashboard directly. ",-1)])),_:1,__:[3]}),e("div",Ie,[t(a(T),{onClick:se,disabled:L.value,variant:"outline",size:"sm"},{default:o(()=>[u(r(L.value?"Checking...":"Check API Permissions"),1)]),_:1},8,["disabled"])])]),_:1}),t(a(_),{class:"space-y-4"},{default:o(()=>[n.value?(l(),d("div",{key:0,class:F(["p-4 border rounded-lg",{"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":!n.value.error,"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":n.value.error}])},[e("div",{class:F(["flex items-center gap-2 mb-2",{"text-green-700 dark:text-green-300":!n.value.error,"text-red-700 dark:text-red-300":n.value.error}])},[t(a(j),{class:"w-5 h-5"}),s[4]||(s[4]=e("span",{class:"font-medium"},"API Permissions Status",-1))],2),n.value.error?(l(),d("div",Pe,r(n.value.error),1)):(l(),d("div",Fe,[e("div",Te,[s[5]||(s[5]=e("span",{class:"font-medium"},"DNS API:",-1)),e("span",{class:F(n.value.dns_api?.accessible?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},r(n.value.dns_api?.accessible?"✓ Accessible":"✗ Not Accessible"),3),n.value.dns_api?.accessible?m("",!0):(l(),d("span",Ue," ("+r(n.value.dns_api?.message)+") ",1))]),e("div",Ee,[s[6]||(s[6]=e("span",{class:"font-medium"},"Domains API:",-1)),e("span",{class:F(n.value.domains_api?.accessible?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},r(n.value.domains_api?.accessible?"✓ Accessible":"✗ Not Accessible"),3),n.value.domains_api?.accessible?m("",!0):(l(),d("span",Ne," ("+r(n.value.domains_api?.message)+") ",1))])]))],2)):m("",!0),G.value?(l(),d("div",$e,[e("div",Me,[t(a(pe),{class:"w-5 h-5"}),s[7]||(s[7]=e("span",{class:"font-medium"},"Subdomain Active",-1))]),e("div",je,[s[8]||(s[8]=e("span",{class:"text-sm text-green-600 dark:text-green-400"}," Your company subdomain: ",-1)),e("a",{href:R.value,target:"_blank",class:"inline-flex items-center gap-1 text-sm font-medium text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300"},[u(r(R.value)+" ",1),t(a(de),{class:"w-3 h-3"})],8,ze)])])):m("",!0),G.value?(l(),d("div",Be,[e("div",Ve,[t(a(z),{class:"w-5 h-5"}),s[9]||(s[9]=e("span",{class:"font-medium"},"Sub Domain Linked",-1))]),s[10]||(s[10]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Your company subdomain is already active and linked. ",-1))])):(l(),d("div",De,[e("div",Ge,[e("div",null,[t(a(J),{for:"company-name",class:"text-sm font-medium"},{default:o(()=>s[11]||(s[11]=[u(" Company Name ",-1)])),_:1,__:[11]}),t(a(q),{id:"company-name",modelValue:a(h).company_name,"onUpdate:modelValue":s[0]||(s[0]=I=>a(h).company_name=I),type:"text",placeholder:"Enter your company name",class:"mt-1"},null,8,["modelValue"]),s[12]||(s[12]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},' This will be converted to a subdomain (e.g., "My Company" → "my-company.zaptask.co.uk") ',-1))]),t(a(T),{onClick:ee,disabled:x.value||!a(h).company_name,class:"w-full"},{default:o(()=>[t(a(z),{class:"w-4 h-4 mr-2"}),u(" "+r(x.value?"Creating Subdomain...":"Create Company Subdomain"),1)]),_:1},8,["disabled"])])]))]),_:1})]),_:1})):m("",!0),k.value?(l(),P(a(b),{key:5},{default:o(()=>[t(a(U),null,{default:o(()=>[t(a(E),null,{default:o(()=>s[13]||(s[13]=[u("Current Logo",-1)])),_:1,__:[13]}),t(a(M),null,{default:o(()=>s[14]||(s[14]=[u(" This is how your logo currently appears in the application. ",-1)])),_:1,__:[14]})]),_:1}),t(a(_),null,{default:o(()=>[e("div",Re,[e("div",Ze,[e("div",Ye,[A.value?(l(),d("img",{key:0,src:D.value,alt:i.company?.name+" logo",class:"object-contain"},null,8,qe)):(l(),d("div",Je,s[15]||(s[15]=[e("div",{class:"w-6 h-6 bg-blue-600 dark:bg-blue-400 rounded text-white dark:text-gray-900 flex items-center justify-center"},[e("img",{src:"/zap_icon.png",alt:"ZapTask",class:"w-4 h-4 dark:hidden"}),e("img",{src:"/zap_icon_white.svg",alt:"ZapTask",class:"w-4 h-4 hidden dark:block"})],-1),e("span",null,"ZapTask",-1)])))]),e("div",null,[e("p",Xe,r(A.value?"Custom Logo":"Default ZapTask Logo"),1),e("p",Ke,r(A.value?"Your company's custom logo":"Standard ZapTask branding"),1)])]),A.value?(l(),P(a(T),{key:0,onClick:W,disabled:C.value,variant:"outline",class:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300"},{default:o(()=>[t(a(ie),{class:"w-4 h-4 mr-2"}),u(" "+r(C.value?"Removing...":"Remove Logo"),1)]),_:1},8,["disabled"])):m("",!0)])]),_:1})]),_:1})):m("",!0),k.value?(l(),P(a(b),{key:6},{default:o(()=>[t(a(U),null,{default:o(()=>[t(a(E),{class:"flex items-center gap-2"},{default:o(()=>[t(a(ue),{class:"w-5 h-5"}),s[16]||(s[16]=u(" Upload New Logo ",-1))]),_:1,__:[16]}),t(a(M),null,{default:o(()=>s[17]||(s[17]=[u(" Upload a custom logo for your company. The logo will replace the ZapTask branding. ",-1)])),_:1,__:[17]})]),_:1}),t(a(_),{class:"space-y-4"},{default:o(()=>[e("div",He,[t(a(j),{class:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e("div",Oe,[s[21]||(s[21]=e("p",{class:"font-medium mb-1"},"Logo Requirements:",-1)),e("ul",Qe,[s[18]||(s[18]=e("li",null,"• Recommended size: 216px width × 48px height",-1)),s[19]||(s[19]=e("li",null,"• Supported formats: PNG, JPG, JPEG, SVG",-1)),s[20]||(s[20]=e("li",null,"• Maximum file size: 2MB",-1)),e("li",null,"• Filename will be: "+r(i.company?.name?.replace(/\s+/g,"_"))+"_"+r(i.company?.code)+"_timestamp",1)])])]),e("div",null,[t(a(J),{for:"logo-upload",class:"text-sm font-medium"},{default:o(()=>s[22]||(s[22]=[u(" Select Logo File ",-1)])),_:1,__:[22]}),t(a(q),{id:"logo-upload",ref_key:"fileInput",ref:N,type:"file",accept:"image/png,image/jpg,image/jpeg,image/svg+xml",onChange:O,class:"mt-1"},null,512)]),g.value?(l(),d("div",We,[t(a(me),{class:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e("div",es,[e("p",ss,r(g.value.name),1),e("p",as,r((g.value.size/1024).toFixed(1))+" KB ",1)]),t(a(T),{onClick:Q,disabled:w.value,class:"ml-auto"},{default:o(()=>[u(r(w.value?"Uploading...":"Upload Logo"),1)]),_:1},8,["disabled"])])):m("",!0)]),_:1})]),_:1})):m("",!0)])]),_:1})]),_:1})],64))}});export{hs as default};
